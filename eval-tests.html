<!DOCTYPE HTML>
<html><head><link rel="stylesheet" href="style.css" type="text/css"><meta charset="UTF-8"></head><body><div id="main-output"><div class="cell"><div class="code-block"><span class="command">:p</span> 1<span class="symbol">.</span>0 <span class="symbol">+</span> 2<span class="symbol">.</span>0
</div><div class="result-block">3.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
   double <span class="symbol">=</span> <span class="symbol">\</span>x<span class="symbol">.</span> x <span class="symbol">*</span> 2<span class="symbol">.</span>0
   double 10<span class="symbol">.</span>0
</div><div class="result-block">20.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> sum (iota (<span class="type-name">Fin</span> 10))
</div><div class="result-block">45</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
   x <span class="symbol">=</span> iota (<span class="type-name">Fin</span> 10)
   sum (<span class="keyword">for</span> i<span class="symbol">.</span> x<span class="symbol">.</span>i)
</div><div class="result-block">45</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
   x <span class="symbol">=</span> iota (<span class="type-name">Fin</span> 3)
   prod (<span class="keyword">for</span> i<span class="symbol">.</span> x<span class="symbol">.</span>i <span class="symbol">+</span> 1)
</div><div class="result-block">6</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
   vdot&#39; <span class="symbol">:</span> n<span class="symbol">:</span><span class="type-name">Type</span> <span class="symbol">?-&gt;</span> n<span class="symbol">=&gt;</span><span class="type-name">Real</span> <span class="symbol">-&gt;</span> n<span class="symbol">=&gt;</span><span class="type-name">Real</span> <span class="symbol">-&gt;</span> <span class="type-name">Real</span> <span class="symbol">=</span>
     <span class="symbol">\</span>x y<span class="symbol">.</span> sum (<span class="keyword">for</span> i<span class="symbol">.</span> x<span class="symbol">.</span>i <span class="symbol">*</span> y<span class="symbol">.</span>i <span class="symbol">*</span> 2<span class="symbol">.</span>0)
   x <span class="symbol">=</span> iota (<span class="type-name">Fin</span> 3)
   y <span class="symbol">=</span> map i2r x
   vdot&#39; y y
</div><div class="result-block">10.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
   x <span class="symbol">=</span> iota <span class="symbol">$</span> <span class="type-name">Fin</span> 3
   y <span class="symbol">=</span> iota <span class="symbol">$</span> <span class="type-name">Fin</span> 4
   z <span class="symbol">=</span> <span class="keyword">for</span> i j<span class="symbol">.</span> i2r x<span class="symbol">.</span>i <span class="symbol">*</span> i2r y<span class="symbol">.</span>j
   sum (<span class="keyword">for</span> i<span class="symbol">.</span> sum z<span class="symbol">.</span>i)
</div><div class="result-block">18.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- :p randint (hash 0 0) 10
</span></div></div><div class="cell"><div class="code-block"><span class="comment">-- :p let x = unpack range 10000
</span></div></div><div class="cell"><div class="code-block"><span class="comment">--        key = hash 0
</span></div></div><div class="cell"><div class="code-block"><span class="comment">--    in sum (for i: randint (key x.i) 10)
</span></div></div><div class="cell"><div class="code-block"><span class="type-name">NArr</span> <span class="symbol">=</span> <span class="type-name">Fin</span> 7
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block">arr <span class="symbol">=</span> iota <span class="type-name">NArr</span>
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> <span class="keyword">for</span> i<span class="symbol">:</span><span class="type-name">NArr</span><span class="symbol">.</span> (iota _)<span class="symbol">.</span>i <span class="symbol">+</span> (iota _)<span class="symbol">.</span>i
</div><div class="result-block">[0, 2, 4, 6, 8, 10, 12]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> sum <span class="keyword">for</span> i<span class="symbol">:</span><span class="type-name">NArr</span><span class="symbol">.</span> 1
</div><div class="result-block">7</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block">fun <span class="symbol">=</span> <span class="symbol">\</span>y<span class="symbol">.</span> sum (map i2r arr) <span class="symbol">+</span> y
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> fun 3<span class="symbol">.</span>0
</div><div class="result-block">24.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> arr
</div><div class="result-block">[0, 1, 2, 3, 4, 5, 6]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> fold 0 <span class="symbol">\</span>i<span class="symbol">.</span> (<span class="symbol">+</span>) arr<span class="symbol">.</span>i
</div><div class="result-block">21</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> 6<span class="symbol">.</span>0 <span class="symbol">-</span> 10<span class="symbol">.</span>0
</div><div class="result-block">-4.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> (<span class="symbol">\</span>(x<span class="symbol">,</span> y)<span class="symbol">.</span> x <span class="symbol">+</span> y) (1<span class="symbol">.</span>0<span class="symbol">,</span> 2<span class="symbol">.</span>0)
</div><div class="result-block">3.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
   f <span class="symbol">:</span> a<span class="symbol">:</span><span class="type-name">Type</span> <span class="symbol">?-&gt;</span> b<span class="symbol">:</span><span class="type-name">Type</span> <span class="symbol">?-&gt;</span> (a <span class="symbol">-&gt;</span> b <span class="symbol">&amp;</span> a) <span class="symbol">-&gt;</span> b <span class="symbol">=</span>
     <span class="symbol">\</span>(x<span class="symbol">,</span> y)<span class="symbol">.</span> x y
   f (<span class="symbol">\</span>x<span class="symbol">.</span> x<span class="symbol">,</span> 1)
</div><div class="result-block">1</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
   (x<span class="symbol">,</span>y) <span class="symbol">=</span> ((1<span class="symbol">.</span>0<span class="symbol">,</span>2<span class="symbol">.</span>0)<span class="symbol">,</span>3<span class="symbol">.</span>0)
   (x1<span class="symbol">,</span> x2) <span class="symbol">=</span> x
   x1 <span class="symbol">+</span> x2 <span class="symbol">+</span> y
</div><div class="result-block">6.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
   x <span class="symbol">=</span> (1<span class="symbol">.</span>0<span class="symbol">,</span>2<span class="symbol">.</span>0)
   (y<span class="symbol">,</span>z) <span class="symbol">=</span> x
   y <span class="symbol">+</span> z
</div><div class="result-block">3.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- :p let f (x, y) = x + 2 * y;
</span></div></div><div class="cell"><div class="code-block"><span class="comment">--        z.i = (x.i, x.i * x.i)
</span></div></div><div class="cell"><div class="code-block"><span class="comment">--    in sum (for i. f z.i)
</span></div></div><div class="cell"><div class="code-block"><span class="command">:p</span> exp 1<span class="symbol">.</span>0
</div><div class="result-block">2.7182817</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> exp2 3<span class="symbol">.</span>0
</div><div class="result-block">8.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> log 1<span class="symbol">.</span>0
</div><div class="result-block">0.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> log2 8<span class="symbol">.</span>0
</div><div class="result-block">3.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> log10 100<span class="symbol">.</span>0
</div><div class="result-block">2.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> sqrt 2<span class="symbol">.</span>0
</div><div class="result-block">1.4142135</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> sin 3<span class="symbol">.</span>14159
</div><div class="result-block">2.6535897e-6</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> cos 0<span class="symbol">.</span>0
</div><div class="result-block">1.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> tan 1<span class="symbol">.</span>57079
</div><div class="result-block">158057.9</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> floor 3<span class="symbol">.</span>6
</div><div class="result-block">3</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> ceil 3<span class="symbol">.</span>6
</div><div class="result-block">4</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> round 3<span class="symbol">.</span>6
</div><div class="result-block">4</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block">s <span class="symbol">=</span> 1<span class="symbol">.</span>0
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> s
</div><div class="result-block">1.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> [2<span class="symbol">,</span> 4<span class="symbol">,</span> 8]
</div><div class="result-block">[2, 4, 8]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
   xs <span class="symbol">=</span> [2<span class="symbol">,</span>1<span class="symbol">,</span>0]
   <span class="keyword">for</span> i<span class="symbol">.</span> xs<span class="symbol">.</span>i <span class="symbol">+</span> 10
</div><div class="result-block">[12, 11, 10]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block">cumsumplus <span class="symbol">:</span> n<span class="symbol">=&gt;</span><span class="type-name">Real</span> <span class="symbol">-&gt;</span> n<span class="symbol">=&gt;</span><span class="type-name">Real</span> <span class="symbol">=</span>
 <span class="symbol">\</span>xs<span class="symbol">.</span> snd <span class="symbol">$</span> scan 0<span class="symbol">.</span>0 <span class="symbol">\</span>i c<span class="symbol">.</span>
   ans <span class="symbol">=</span> c <span class="symbol">+</span> xs<span class="symbol">.</span>i
   (ans<span class="symbol">,</span> 1<span class="symbol">.</span>0 <span class="symbol">+</span> ans)
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> cumsumplus [1<span class="symbol">.</span>0<span class="symbol">,</span> 2<span class="symbol">.</span>0<span class="symbol">,</span> 3<span class="symbol">.</span>0]
</div><div class="result-block">[2.0, 4.0, 7.0]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> [<span class="type-name">False</span><span class="symbol">,</span> <span class="type-name">False</span><span class="symbol">,</span> <span class="type-name">True</span>]
</div><div class="result-block">[False, False, True]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> [<span class="type-name">False</span><span class="symbol">,</span> <span class="type-name">True</span><span class="symbol">,</span> <span class="type-name">True</span><span class="symbol">,</span> <span class="type-name">False</span>]  <span class="comment">-- testing again because it&#39;s been flaky
</span></div><div class="result-block">[False, True, True, False]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> (<span class="type-name">True</span><span class="symbol">,</span> <span class="type-name">False</span>)
</div><div class="result-block">(True, False)</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> 1<span class="symbol">.</span>0 <span class="symbol">&gt;</span> 2<span class="symbol">.</span>0
</div><div class="result-block">False</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> 1<span class="symbol">.</span>0 <span class="symbol">&gt;</span> neg 2<span class="symbol">.</span>0
</div><div class="result-block">True</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> 1<span class="symbol">.</span>0 <span class="symbol">&lt;</span> 2<span class="symbol">.</span>0
</div><div class="result-block">True</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> b2i (1<span class="symbol">.</span>0 <span class="symbol">&lt;</span> 2<span class="symbol">.</span>0)
</div><div class="result-block">1</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> [ 1 <span class="symbol">&lt;</span> 2<span class="symbol">,</span> 1<span class="symbol">.</span>0 <span class="symbol">&lt;</span> 2<span class="symbol">.</span>0<span class="symbol">,</span>  2 <span class="symbol">&lt;</span> 2<span class="symbol">,</span> 2<span class="symbol">.</span>0 <span class="symbol">&lt;</span> 2<span class="symbol">.</span>0<span class="symbol">,</span> 2 <span class="symbol">&lt;</span> 1<span class="symbol">,</span> 2<span class="symbol">.</span>0 <span class="symbol">&lt;</span> 1<span class="symbol">.</span>0]
</div><div class="result-block">[True, True, False, False, False, False]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> [ 1 <span class="symbol">&gt;</span> 2<span class="symbol">,</span> 1<span class="symbol">.</span>0 <span class="symbol">&gt;</span> 2<span class="symbol">.</span>0<span class="symbol">,</span>  2 <span class="symbol">&gt;</span> 2<span class="symbol">,</span> 2<span class="symbol">.</span>0 <span class="symbol">&gt;</span> 2<span class="symbol">.</span>0<span class="symbol">,</span> 2 <span class="symbol">&gt;</span> 1<span class="symbol">,</span> 2<span class="symbol">.</span>0 <span class="symbol">&gt;</span> 1<span class="symbol">.</span>0]
</div><div class="result-block">[False, False, False, False, True, True]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> [ 1 <span class="symbol">&lt;=</span> 2<span class="symbol">,</span> 1<span class="symbol">.</span>0 <span class="symbol">&lt;=</span> 2<span class="symbol">.</span>0<span class="symbol">,</span>  2 <span class="symbol">&lt;=</span> 2<span class="symbol">,</span> 2<span class="symbol">.</span>0 <span class="symbol">&lt;=</span> 2<span class="symbol">.</span>0<span class="symbol">,</span> 2 <span class="symbol">&lt;</span> 1<span class="symbol">,</span> 2<span class="symbol">.</span>0 <span class="symbol">&lt;</span> 1<span class="symbol">.</span>0]
</div><div class="result-block">[True, True, True, True, False, False]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> [ 1 <span class="symbol">&gt;=</span> 2<span class="symbol">,</span> 1<span class="symbol">.</span>0 <span class="symbol">&gt;=</span> 2<span class="symbol">.</span>0<span class="symbol">,</span>  2 <span class="symbol">&gt;=</span> 2<span class="symbol">,</span> 2<span class="symbol">.</span>0 <span class="symbol">&gt;=</span> 2<span class="symbol">.</span>0<span class="symbol">,</span> 2 <span class="symbol">&gt;=</span> 1<span class="symbol">,</span> 2<span class="symbol">.</span>0 <span class="symbol">&gt;=</span> 1<span class="symbol">.</span>0]
</div><div class="result-block">[False, False, True, True, True, True]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block">infty <span class="symbol">=</span> 1<span class="symbol">./</span>0<span class="symbol">.</span>
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> infty
</div><div class="result-block">Infinity</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block">nan <span class="symbol">=</span> 0<span class="symbol">./</span>0<span class="symbol">.</span>
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> nan
</div><div class="result-block">NaN</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> [ 0<span class="symbol">.</span> <span class="symbol">&lt;</span> infty<span class="symbol">,</span> 0<span class="symbol">.</span> <span class="symbol">&lt;</span> nan<span class="symbol">,</span> infty <span class="symbol">&lt;</span> 0<span class="symbol">.,</span> nan <span class="symbol">&lt;</span> 0<span class="symbol">.,</span> nan <span class="symbol">&lt;</span> nan<span class="symbol">,</span> infty <span class="symbol">&lt;</span> infty ]
</div><div class="result-block">[True, False, False, False, False, False]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="type-name">N3</span> <span class="symbol">=</span> <span class="type-name">Fin</span> 3
</div></div><div class="cell"><div class="code-block"><span class="type-name">N4</span> <span class="symbol">=</span> <span class="type-name">Fin</span> 4
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block">mat <span class="symbol">=</span> <span class="keyword">for</span> i<span class="symbol">:</span><span class="type-name">N3</span> j<span class="symbol">:</span><span class="type-name">N4</span><span class="symbol">.</span> (iota _)<span class="symbol">.</span>i <span class="symbol">+</span> (10 <span class="symbol">*</span> (iota _)<span class="symbol">.</span>j)
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- :p sum for (i,j). mat.i.j
</span></div></div><div class="cell"><div class="code-block"><span class="comment">-- &gt; 192
</span></div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block">litArr <span class="symbol">=</span> [10<span class="symbol">,</span> 5<span class="symbol">,</span> 3]
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> mod 5 3
</div><div class="result-block">2</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> size (<span class="type-name">Fin</span> 3)
</div><div class="result-block">3</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 3)<span class="symbol">.</span> 1
</div><div class="result-block">[1, 1, 1]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
   (k<span class="symbol">,</span> _) <span class="symbol">=</span> (1 <span class="symbol">+</span> 2<span class="symbol">,</span> 3)
   <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 6)<span class="symbol">.</span> k <span class="symbol">+</span> ordinal i
</div><div class="result-block">[3, 4, 5, 6, 7, 8]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
   k <span class="symbol">=</span> newKey 0
   mean <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 100)<span class="symbol">.</span> randn (ixkey k i)
</div><div class="result-block">-0.115799494</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
   k <span class="symbol">=</span> newKey 0
   mean <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 100)<span class="symbol">.</span> sq <span class="symbol">$</span> randn (ixkey k i)
</div><div class="result-block">1.2581897</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 3) j<span class="symbol">:</span>(<span class="type-name">Fin</span> 2)<span class="symbol">.</span> rand <span class="symbol">$</span> ixkey2 (newKey 11) i j
</div><div class="result-block">[[0.47415292, 0.9145164], [0.7944602, 0.27679908], [0.58958626, 0.7116251]]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  x <span class="symbol">=</span> <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 3)<span class="symbol">.</span> 0
  x
</div><div class="result-block">[0, 0, 0]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
   x <span class="symbol">=</span> <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 3)<span class="symbol">.</span> <span class="keyword">for</span> j<span class="symbol">:</span>(<span class="type-name">Fin</span> 4)<span class="symbol">.</span> 0
   x
</div><div class="result-block">[[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> fold (<span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 3)<span class="symbol">.</span> 0<span class="symbol">.</span>0) <span class="symbol">$</span> <span class="symbol">\</span>i<span class="symbol">:</span>(<span class="type-name">Fin</span> 2) c<span class="symbol">.</span> (<span class="keyword">for</span> j<span class="symbol">.</span> c<span class="symbol">.</span>j <span class="symbol">+</span> i2r (ordinal j))
</div><div class="result-block">[0.0, 2.0, 4.0]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
   mat2 <span class="symbol">=</span> <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 4) j<span class="symbol">:</span>(<span class="type-name">Fin</span> 4) <span class="symbol">.</span> ordinal i
   tmp <span class="symbol">=</span> <span class="keyword">for</span> i<span class="symbol">.</span> mat2<span class="symbol">.</span>i<span class="symbol">.</span>i
   tmp
</div><div class="result-block">[0, 1, 2, 3]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  x <span class="symbol">=</span> [[0<span class="symbol">,</span> 1]<span class="symbol">,</span> [2<span class="symbol">,</span> 3]]
  xt <span class="symbol">=</span> <span class="keyword">for</span> i j<span class="symbol">.</span> x<span class="symbol">.</span>j<span class="symbol">.</span>i
  xt
</div><div class="result-block">[[0, 2], [1, 3]]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  (x<span class="symbol">,</span> y) <span class="symbol">=</span> (1<span class="symbol">,</span> (2<span class="symbol">,</span>3))
  (x<span class="symbol">,</span> y)
</div><div class="result-block">(1, (2, 3))</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 3)<span class="symbol">.</span> i
</div><div class="result-block">[0@(Fin 3), 1@(Fin 3), 2@(Fin 3)]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 3)<span class="symbol">.</span> i
</div><div class="result-block">[0@(Fin 3), 1@(Fin 3), 2@(Fin 3)]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> fromOrdinal (<span class="type-name">Fin</span> 1) 0
</div><div class="result-block">0@(Fin 1)</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> 0<span class="symbol">@</span>(<span class="type-name">Fin</span> 1)
</div><div class="result-block">0@(Fin 1)</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> [1<span class="symbol">,</span> 2<span class="symbol">,</span> 3]<span class="symbol">.</span>(0<span class="symbol">@</span>_)
</div><div class="result-block">1</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> [0]<span class="symbol">.</span>([asidx 0]<span class="symbol">.</span>(asidx 0))
</div><div class="result-block">0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> select <span class="type-name">True</span> 1 2
</div><div class="result-block">1</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> select <span class="type-name">False</span> 1<span class="symbol">.</span>0 2<span class="symbol">.</span>0
</div><div class="result-block">2.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> select <span class="type-name">True</span> [1<span class="symbol">,</span>2<span class="symbol">,</span>3] [10<span class="symbol">,</span>20<span class="symbol">,</span>30]
</div><div class="result-block">[1, 2, 3]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> select <span class="type-name">False</span> [1<span class="symbol">,</span>2<span class="symbol">,</span>3] [10<span class="symbol">,</span>20<span class="symbol">,</span>30]
</div><div class="result-block">[10, 20, 30]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> [(1<span class="symbol">,</span> (<span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 2) <span class="symbol">.</span> 3))]<span class="symbol">.</span>(fromOrdinal _ 0)
</div><div class="result-block">(1, [3, 3])</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> (<span class="type-name">False</span> <span class="symbol">&amp;&amp;</span> <span class="type-name">False</span><span class="symbol">,</span> <span class="type-name">False</span> <span class="symbol">&amp;&amp;</span> <span class="type-name">True</span><span class="symbol">,</span> <span class="type-name">True</span> <span class="symbol">&amp;&amp;</span> <span class="type-name">False</span><span class="symbol">,</span> <span class="type-name">True</span> <span class="symbol">&amp;&amp;</span> <span class="type-name">True</span>)
</div><div class="result-block">(False, (False, (False, True)))</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> (not <span class="type-name">False</span><span class="symbol">,</span> not <span class="type-name">True</span>)
</div><div class="result-block">(True, False)</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> (<span class="type-name">False</span> <span class="symbol">||</span> <span class="type-name">False</span><span class="symbol">,</span> <span class="type-name">False</span> <span class="symbol">||</span> <span class="type-name">True</span><span class="symbol">,</span> <span class="type-name">True</span> <span class="symbol">||</span> <span class="type-name">False</span><span class="symbol">,</span> <span class="type-name">True</span> <span class="symbol">||</span> <span class="type-name">True</span>)
</div><div class="result-block">(False, (True, (True, True)))</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> [(<span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 1)<span class="symbol">.</span> (<span class="type-name">False</span><span class="symbol">,</span> <span class="keyword">for</span> j<span class="symbol">:</span>(<span class="type-name">Fin</span> 2)<span class="symbol">.</span> 1<span class="symbol">.</span>0))<span class="symbol">,</span> [(<span class="type-name">True</span><span class="symbol">,</span> <span class="keyword">for</span> k<span class="symbol">:</span>(<span class="type-name">Fin</span> 2) <span class="symbol">.</span> 2<span class="symbol">.</span>0)]]
</div><div class="result-block">[[(False, [1.0, 1.0])], [(True, [2.0, 2.0])]]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- TODO: parse negative integer literals
</span></div></div><div class="cell"><div class="code-block"><span class="comment">-- :p (mod 5 3, mod 7 3, mod (-1) 3, mod -5 3)
</span></div></div><div class="cell"><div class="code-block"><span class="comment">-- &gt; (2, 1, 2, 1)
</span></div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> [[1<span class="symbol">,</span>2]<span class="symbol">,</span> <span class="keyword">for</span> i<span class="symbol">.</span> 3]
</div><div class="result-block">[[1, 2], [3, 3]]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> select <span class="type-name">False</span> [1<span class="symbol">,</span> 2] (<span class="keyword">for</span> i<span class="symbol">.</span> 3)
</div><div class="result-block">[3, 3]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> fold [1<span class="symbol">,</span> 2] <span class="symbol">\</span>i<span class="symbol">:</span>(<span class="type-name">Fin</span> 3) c<span class="symbol">.</span> <span class="keyword">for</span> j<span class="symbol">.</span> 4
</div><div class="result-block">[4, 4]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> select <span class="type-name">True</span> (1<span class="symbol">,</span>2) (2<span class="symbol">,</span>3)
</div><div class="result-block">(1, 2)</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> select <span class="type-name">False</span> (1<span class="symbol">,</span>[2<span class="symbol">,</span>3]) (4<span class="symbol">,</span> <span class="keyword">for</span> _ <span class="symbol">.</span> 3)
</div><div class="result-block">(4, [3, 3])</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> select <span class="type-name">False</span> () ()
</div><div class="result-block">()</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> [1<span class="symbol">,</span>2<span class="symbol">,</span>3]<span class="symbol">.</span>(fromOrdinal (<span class="type-name">Fin</span> 3) 1 )
</div><div class="result-block">2</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> fold (1<span class="symbol">.</span>0<span class="symbol">,</span> 2<span class="symbol">.</span>0) <span class="symbol">\</span>i<span class="symbol">:</span>(<span class="type-name">Fin</span> 2) (x<span class="symbol">,</span> y)<span class="symbol">.</span> (y<span class="symbol">,</span> x)
</div><div class="result-block">(1.0, 2.0)</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> fold (1<span class="symbol">.</span>0<span class="symbol">,</span> 2<span class="symbol">.</span>0) <span class="symbol">\</span>i<span class="symbol">:</span>(<span class="type-name">Fin</span> 3) (x<span class="symbol">,</span> y)<span class="symbol">.</span> (y<span class="symbol">,</span> x)
</div><div class="result-block">(2.0, 1.0)</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> id 2
</div><div class="result-block">2</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> min 2<span class="symbol">.</span>0 3<span class="symbol">.</span>0
</div><div class="result-block">2.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> minBy sq 0<span class="symbol">.</span>5 (<span class="symbol">-</span>2<span class="symbol">.</span>0)
</div><div class="result-block">0.5</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> minimum [2<span class="symbol">.</span>0<span class="symbol">,</span> 3<span class="symbol">.</span>0<span class="symbol">,</span> 4<span class="symbol">.</span>0<span class="symbol">,</span> 1<span class="symbol">.</span>5<span class="symbol">,</span> 7<span class="symbol">.</span>0]
</div><div class="result-block">1.5</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> minimumBy fst [(2<span class="symbol">.</span>0<span class="symbol">,</span> 20)<span class="symbol">,</span> (1<span class="symbol">.</span>5<span class="symbol">,</span> 15)<span class="symbol">,</span> (10<span class="symbol">.</span>0<span class="symbol">,</span> 100)]
</div><div class="result-block">(1.5, 15)</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> max 2<span class="symbol">.</span>0 3<span class="symbol">.</span>0
</div><div class="result-block">3.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> maxBy sq 0<span class="symbol">.</span>5 (<span class="symbol">-</span>2<span class="symbol">.</span>0)
</div><div class="result-block">-2.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> maximum [2<span class="symbol">.</span>0<span class="symbol">,</span> 4<span class="symbol">.</span>0<span class="symbol">,</span> 1<span class="symbol">.</span>5<span class="symbol">,</span> 7<span class="symbol">.</span>0]
</div><div class="result-block">7.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> maximumBy fst [(2<span class="symbol">.</span>0<span class="symbol">,</span> 20)<span class="symbol">,</span> (1<span class="symbol">.</span>5<span class="symbol">,</span> 15)<span class="symbol">,</span> (10<span class="symbol">.</span>0<span class="symbol">,</span> 100)]
</div><div class="result-block">(10.0, 100)</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> (1 <span class="symbol">==</span> 2<span class="symbol">,</span> (<span class="symbol">-</span>1) <span class="symbol">==</span> (<span class="symbol">-</span>1)<span class="symbol">,</span> 1 <span class="symbol">&lt;</span> 2<span class="symbol">,</span> <span class="symbol">-</span>1 <span class="symbol">&lt;</span> 2<span class="symbol">,</span> 2 <span class="symbol">&lt;</span> (<span class="symbol">-</span>1))
</div><div class="result-block">(False, (True, (True, (True, False))))</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> (1<span class="symbol">.</span> <span class="symbol">==</span> 2<span class="symbol">.,</span> (<span class="symbol">-</span>1<span class="symbol">.</span>) <span class="symbol">==</span> (<span class="symbol">-</span>1<span class="symbol">.</span>)<span class="symbol">,</span> 1<span class="symbol">.</span> <span class="symbol">&lt;</span> 2<span class="symbol">.,</span> (<span class="symbol">-</span>1<span class="symbol">.</span>) <span class="symbol">&lt;</span> 2<span class="symbol">.,</span> 2<span class="symbol">.</span> <span class="symbol">&lt;</span> (<span class="symbol">-</span>1<span class="symbol">.</span>))
</div><div class="result-block">(False, (True, (True, (True, False))))</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 7)<span class="symbol">.</span> select (i <span class="symbol">&lt;</span> (fromOrdinal _ 3)) 1 2
</div><div class="result-block">[1, 1, 1, 2, 2, 2, 2]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block">σ <span class="symbol">=</span> 1<span class="symbol">.</span>0 <span class="symbol">+</span> 2<span class="symbol">.</span>0
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> σ
</div><div class="result-block">3.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block">δ <span class="symbol">:</span> <span class="type-name">Int</span> <span class="symbol">-&gt;</span> <span class="type-name">Int</span> <span class="symbol">=</span> <span class="symbol">\</span>x<span class="symbol">.</span> x
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> δ 3
</div><div class="result-block">3</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> select <span class="type-name">True</span> 1 2
</div><div class="result-block">1</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> select <span class="type-name">True</span> [1<span class="symbol">,</span>2] [2<span class="symbol">,</span>3]
</div><div class="result-block">[1, 2]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> select <span class="type-name">True</span> (1<span class="symbol">,</span>2) (2<span class="symbol">,</span>3)
</div><div class="result-block">(1, 2)</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  x <span class="symbol">=</span> 1; x <span class="symbol">==</span> x
</div><div class="result-block">True</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> 1 <span class="symbol">+</span> 2
</div><div class="result-block">3</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> slice [1<span class="symbol">,</span>2<span class="symbol">,</span>3<span class="symbol">,</span>4<span class="symbol">,</span>5] 2 (<span class="type-name">Fin</span> 3)
</div><div class="result-block">[3, 4, 5]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- TODO: test file specifically for parse errors (including testing error messages)
</span></div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
   f <span class="symbol">:</span> <span class="type-name">Real</span><span class="symbol">-&gt;</span><span class="type-name">Real</span> <span class="symbol">=</span> <span class="symbol">\</span>x<span class="symbol">.</span>
     <span class="comment">-- line comment should be ok here
</span>     2<span class="symbol">.</span>0 <span class="symbol">*</span> x
   f 1<span class="symbol">.</span>0
</div><div class="result-block">2.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- Not sure why the ordinary `sum/for` version doesn&#39;t work anymore
</span></div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
    n <span class="symbol">=</span> 3 <span class="symbol">+</span> 7
    fsum <span class="symbol">\</span>i<span class="symbol">:</span>(<span class="type-name">Fin</span> n)<span class="symbol">.</span> 1<span class="symbol">.</span>0
</div><div class="result-block">10.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
    n <span class="symbol">=</span> 4
    fsum <span class="symbol">\</span>i<span class="symbol">:</span>(<span class="type-name">Fin</span> n)<span class="symbol">.</span> 1<span class="symbol">.</span>0
</div><div class="result-block">4.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  one <span class="symbol">=</span> fromOrdinal (<span class="type-name">Fin</span> 4) 1
  <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 4)<span class="symbol">.</span> sum <span class="keyword">for</span> j<span class="symbol">:</span>(one<span class="symbol">..</span>i)<span class="symbol">.</span> 1<span class="symbol">.</span>0
</div><div class="result-block">[0.0, 1.0, 2.0, 3.0]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  one <span class="symbol">=</span> fromOrdinal (<span class="type-name">Fin</span> 4) 1
  <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 4)<span class="symbol">.</span> sum <span class="keyword">for</span> j<span class="symbol">:</span>(one<span class="symbol">&lt;..</span>i)<span class="symbol">.</span> 1<span class="symbol">.</span>0
</div><div class="result-block">[0.0, 0.0, 1.0, 2.0]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  one <span class="symbol">=</span> fromOrdinal (<span class="type-name">Fin</span> 4) 1
  <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 4)<span class="symbol">.</span> sum <span class="keyword">for</span> j<span class="symbol">:</span>(one<span class="symbol">&lt;..</span>i)<span class="symbol">.</span> 1<span class="symbol">.</span>0
</div><div class="result-block">[0.0, 0.0, 1.0, 2.0]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  one <span class="symbol">=</span> fromOrdinal (<span class="type-name">Fin</span> 4) 1
  <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 4)<span class="symbol">.</span> sum <span class="keyword">for</span> j<span class="symbol">:</span>(one<span class="symbol">..&lt;</span>i)<span class="symbol">.</span> 1<span class="symbol">.</span>0
</div><div class="result-block">[0.0, 0.0, 1.0, 2.0]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  one <span class="symbol">=</span> fromOrdinal (<span class="type-name">Fin</span> 4) 1
  <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 4)<span class="symbol">.</span> sum <span class="keyword">for</span> j<span class="symbol">:</span>(one<span class="symbol">&lt;..&lt;</span>i)<span class="symbol">.</span> 1<span class="symbol">.</span>0
</div><div class="result-block">[0.0, 0.0, 0.0, 1.0]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 4)<span class="symbol">.</span> sum <span class="keyword">for</span> j<span class="symbol">:</span>(<span class="symbol">..</span>i)<span class="symbol">.</span> 1<span class="symbol">.</span>0
</div><div class="result-block">[1.0, 2.0, 3.0, 4.0]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 4)<span class="symbol">.</span> sum <span class="keyword">for</span> j<span class="symbol">:</span>(<span class="symbol">..&lt;</span>i)<span class="symbol">.</span> 1<span class="symbol">.</span>0
</div><div class="result-block">[0.0, 1.0, 2.0, 3.0]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 4)<span class="symbol">.</span> sum <span class="keyword">for</span> j<span class="symbol">:</span>(i<span class="symbol">..</span>)<span class="symbol">.</span> 1<span class="symbol">.</span>0
</div><div class="result-block">[4.0, 3.0, 2.0, 1.0]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 4)<span class="symbol">.</span> sum <span class="keyword">for</span> j<span class="symbol">:</span>(i<span class="symbol">&lt;..</span>)<span class="symbol">.</span> 1<span class="symbol">.</span>0
</div><div class="result-block">[3.0, 2.0, 1.0, 0.0]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> idiv 10 3
</div><div class="result-block">3</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> rem 10 3
</div><div class="result-block">1</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  xs <span class="symbol">=</span> [10<span class="symbol">.,</span>20<span class="symbol">.</span>]
  ys <span class="symbol">=</span> [1<span class="symbol">.,</span>2<span class="symbol">.,</span>3<span class="symbol">.</span>]
  xys <span class="symbol">=</span> <span class="keyword">for</span> (i<span class="symbol">,</span>j)<span class="symbol">.</span> xs<span class="symbol">.</span>i <span class="symbol">+</span> ys<span class="symbol">.</span>j
  sum xys
</div><div class="result-block">102.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  xs <span class="symbol">=</span> [10<span class="symbol">.,</span>20<span class="symbol">.</span>]
  ys <span class="symbol">=</span> [1<span class="symbol">.,</span>2<span class="symbol">.,</span>3<span class="symbol">.</span>]
  zs <span class="symbol">=</span> [1<span class="symbol">.</span>]
  xys <span class="symbol">=</span> <span class="keyword">for</span> (i<span class="symbol">,</span>(j<span class="symbol">,</span>k))<span class="symbol">.</span> xs<span class="symbol">.</span>i <span class="symbol">+</span> ys<span class="symbol">.</span>j <span class="symbol">+</span> zs<span class="symbol">.</span>k
  sum xys
</div><div class="result-block">108.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  xs <span class="symbol">=</span> [[1<span class="symbol">,</span>2]<span class="symbol">,</span>[3<span class="symbol">,</span>4]]
  ys <span class="symbol">=</span> <span class="keyword">for</span> (i<span class="symbol">,</span>j)<span class="symbol">.</span> xs<span class="symbol">.</span>i<span class="symbol">.</span>j
  zs <span class="symbol">=</span> <span class="keyword">for</span> (i<span class="symbol">,</span>j)<span class="symbol">.</span> ys<span class="symbol">.</span>(i<span class="symbol">,</span>j)
  <span class="keyword">for</span> i j<span class="symbol">.</span> zs<span class="symbol">.</span>(j<span class="symbol">,</span>i)
</div><div class="result-block">[[1, 3], [2, 4]]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> argmin [1<span class="symbol">.</span>0<span class="symbol">,</span> 2<span class="symbol">.</span>0<span class="symbol">,</span> 0<span class="symbol">.</span>4<span class="symbol">,</span> 5<span class="symbol">.</span>0]
</div><div class="result-block">2@(Fin 4)</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> select <span class="type-name">True</span> (fromOrdinal (<span class="type-name">Fin</span> 2) 0) (fromOrdinal (<span class="type-name">Fin</span> 2) 1)
</div><div class="result-block">0@(Fin 2)</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- TODO: printing (also parsing) tables with alternative index sets
</span></div></div><div class="cell"><div class="code-block"><span class="comment">-- :p
</span></div></div><div class="cell"><div class="code-block"><span class="comment">--   xs = [[1],[2]]
</span></div></div><div class="cell"><div class="code-block"><span class="comment">--   for (i,j). xs.i.j
</span></div></div><div class="cell"><div class="code-block"><span class="comment">-- &gt; [1, 2]@(2, 1)
</span></div></div><div class="cell"><div class="code-block">

</div></div><div class="cell"><div class="code-block"><span class="comment">-- TODO: injections
</span></div></div><div class="cell"><div class="code-block"><span class="comment">-- :p
</span></div></div><div class="cell"><div class="code-block"><span class="comment">--   xs = for i:5. 1.0
</span></div></div><div class="cell"><div class="code-block"><span class="comment">--   two = fromOrdinal (Fin 5) 2
</span></div></div><div class="cell"><div class="code-block"><span class="comment">--   for i:3. sum for j:(two&lt;..). xs.(%inject(j))
</span></div></div><div class="cell"><div class="code-block"><span class="comment">-- &gt; [2.0, 2.0, 2.0]
</span></div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  withState 0<span class="symbol">.</span>0 <span class="symbol">\</span>ref<span class="symbol">.</span> <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 4)<span class="symbol">.</span>
      c <span class="symbol">=</span> get ref
      ref <span class="symbol">:=</span> c <span class="symbol">+</span> 1<span class="symbol">.</span>0
      c
</div><div class="result-block">([0.0, 1.0, 2.0, 3.0], 4.0)</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  withState 0<span class="symbol">.</span>0 <span class="symbol">\</span>ref<span class="symbol">.</span> <span class="keyword">rof</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 4)<span class="symbol">.</span>
      c <span class="symbol">=</span> get ref
      ref <span class="symbol">:=</span> c <span class="symbol">+</span> 1<span class="symbol">.</span>0
      c
</div><div class="result-block">([3.0, 2.0, 1.0, 0.0], 4.0)</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> eitherFloor (x<span class="symbol">:</span><span class="type-name">Int</span><span class="symbol">|</span><span class="type-name">Real</span>) <span class="symbol">:</span> <span class="type-name">Int</span> <span class="symbol">=</span> <span class="keyword">oldcase</span> x
  <span class="type-name">Left</span> i  <span class="symbol">-&gt;</span> i
  <span class="type-name">Right</span> f <span class="symbol">-&gt;</span> floor f
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> eitherFloor (<span class="type-name">Right</span> 1<span class="symbol">.</span>2)
</div><div class="result-block">1</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  x <span class="symbol">:</span> <span class="type-name">Int</span><span class="symbol">|</span><span class="type-name">Real</span> <span class="symbol">=</span> <span class="type-name">Right</span> 1<span class="symbol">.</span>2
  x
</div><div class="result-block">(Right 1.2)</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- Sum types as flattened index sets!
</span></div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> <span class="type-name">Weights</span> (n<span class="symbol">:</span><span class="type-name">Type</span>) (m<span class="symbol">:</span><span class="type-name">Type</span>) <span class="symbol">:</span> <span class="type-name">Type</span> <span class="symbol">=</span> n<span class="symbol">=&gt;</span>m<span class="symbol">=&gt;</span><span class="type-name">Real</span>
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> <span class="type-name">Biases</span>  (n<span class="symbol">:</span><span class="type-name">Type</span>)          <span class="symbol">:</span> <span class="type-name">Type</span> <span class="symbol">=</span> n<span class="symbol">=&gt;</span><span class="type-name">Real</span>
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> <span class="type-name">Params</span>  (n<span class="symbol">:</span><span class="type-name">Type</span>) (m<span class="symbol">:</span><span class="type-name">Type</span>) <span class="symbol">:</span> <span class="type-name">Type</span> <span class="symbol">=</span> ((n<span class="symbol">&amp;</span>m)<span class="symbol">|</span>n)<span class="symbol">=&gt;</span><span class="type-name">Real</span>
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block">w <span class="symbol">=</span> <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 2)<span class="symbol">.</span> <span class="keyword">for</span> j<span class="symbol">:</span>(<span class="type-name">Fin</span> 3)<span class="symbol">.</span> (i2r (ordinal i)) <span class="symbol">*</span> 3<span class="symbol">.</span>0 <span class="symbol">+</span> (i2r (ordinal j))
</div></div><div class="cell"><div class="code-block">b <span class="symbol">=</span> <span class="keyword">for</span> j<span class="symbol">:</span>(<span class="type-name">Fin</span> 2)<span class="symbol">.</span> neg (i2r (ordinal j) <span class="symbol">+</span> 1<span class="symbol">.</span>0)
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> flatten ((w<span class="symbol">,</span>b)<span class="symbol">:</span>(<span class="type-name">Weights</span> n m <span class="symbol">&amp;</span> <span class="type-name">Biases</span> n))<span class="symbol">:</span> <span class="type-name">Params</span> n m <span class="symbol">=</span>
  <span class="keyword">for</span> idx<span class="symbol">.</span> <span class="keyword">oldcase</span> idx
    <span class="type-name">Left</span> (i<span class="symbol">,</span>j) <span class="symbol">-&gt;</span> w<span class="symbol">.</span>i<span class="symbol">.</span>j
    <span class="type-name">Right</span> i    <span class="symbol">-&gt;</span> b<span class="symbol">.</span>i
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> unflatten (params<span class="symbol">:</span><span class="type-name">Params</span> n m) <span class="symbol">:</span> (<span class="type-name">Weights</span> n m <span class="symbol">&amp;</span> <span class="type-name">Biases</span> n) <span class="symbol">=</span>
  ( <span class="keyword">for</span> i<span class="symbol">.</span> <span class="keyword">for</span> j<span class="symbol">.</span> params<span class="symbol">.</span>(<span class="type-name">Left</span> (i<span class="symbol">,</span>j))
  <span class="symbol">,</span> <span class="keyword">for</span> i<span class="symbol">.</span>        params<span class="symbol">.</span>(<span class="type-name">Right</span> i)    )
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> unflatten (flatten (w<span class="symbol">,</span> b)) <span class="symbol">==</span> (w<span class="symbol">,</span> b)
</div><div class="result-block">True</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> [1<span class="symbol">,</span>2<span class="symbol">,</span>3] <span class="symbol">==</span> [1<span class="symbol">,</span>2<span class="symbol">,</span>3]
</div><div class="result-block">True</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> [1<span class="symbol">,</span>2<span class="symbol">,</span>4] <span class="symbol">==</span> [1<span class="symbol">,</span>2<span class="symbol">,</span>3]
</div><div class="result-block">False</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> (1<span class="symbol">,</span> 2) <span class="symbol">==</span> (1<span class="symbol">,</span> 2)
</div><div class="result-block">True</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> (<span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 4)<span class="symbol">.</span> (1<span class="symbol">.</span>0<span class="symbol">,</span> ordinal i)) <span class="symbol">==</span> (<span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 4)<span class="symbol">.</span> (1<span class="symbol">.</span>0<span class="symbol">,</span> ordinal i))
</div><div class="result-block">True</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> (1<span class="symbol">,</span> 1) <span class="symbol">==</span> (1<span class="symbol">,</span> 2)
</div><div class="result-block">False</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> (<span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 4)<span class="symbol">.</span> 1<span class="symbol">.</span>0) <span class="symbol">==</span> (<span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 4)<span class="symbol">.</span> 2<span class="symbol">.</span>0)
</div><div class="result-block">False</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- Userspace-Bool breaks these
</span></div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- -- Needed to avoid ambiguous type variables if both sides use the same constructor
</span></div></div><div class="cell"><div class="code-block"><span class="comment">-- def cmpEither (x:Int|Int) (y:Int|Int) : Bool = x == y
</span></div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- :p cmpEither (Left 1) (Left 1)
</span></div></div><div class="cell"><div class="code-block"><span class="comment">-- &gt; True
</span></div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- :p cmpEither (Left 1) (Left 2)
</span></div></div><div class="cell"><div class="code-block"><span class="comment">-- &gt; False
</span></div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- :p cmpEither (Left 1) (Right 1)
</span></div></div><div class="cell"><div class="code-block"><span class="comment">-- &gt; False
</span></div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- TODO: within-module version of this (currently fails in Imp checking)
</span></div></div><div class="cell"><div class="code-block">upperBound <span class="symbol">=</span> sum <span class="symbol">$</span> <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 4)<span class="symbol">.</span> 1
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> <span class="keyword">for</span> j<span class="symbol">:</span>(<span class="type-name">Fin</span> upperBound)<span class="symbol">.</span> 1<span class="symbol">.</span>0
</div><div class="result-block">[1.0, 1.0, 1.0, 1.0]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> (<span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> upperBound)<span class="symbol">.</span> 1<span class="symbol">,</span> <span class="keyword">for</span> j<span class="symbol">:</span>(<span class="type-name">Fin</span> 2)<span class="symbol">.</span> 2)
</div><div class="result-block">([1, 1, 1, 1], [2, 2])</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 4)<span class="symbol">.</span>
  x <span class="symbol">=</span> 1 <span class="symbol">+</span> 1
  (x<span class="symbol">,</span> x)
</div><div class="result-block">[(2, 2), (2, 2), (2, 2), (2, 2)]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  x <span class="symbol">=</span> 2
  z <span class="symbol">=</span> <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 4)<span class="symbol">.</span>
        y <span class="symbol">=</span> 2 <span class="symbol">+</span> 3
        (x<span class="symbol">,</span> y)
  (x<span class="symbol">,</span> z)
</div><div class="result-block">(2, [(2, 5), (2, 5), (2, 5), (2, 5)])</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Range</span> 4 1)<span class="symbol">.</span> 1<span class="symbol">.</span>0
</div><div class="result-block">[]@(%IntRange 4 1)</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block">x <span class="symbol">=</span> 2 <span class="symbol">-</span> 4
</div></div><div class="cell"><div class="code-block"><span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Range</span> 0 x)<span class="symbol">.</span> 1<span class="symbol">.</span>0
</div><div class="result-block">[]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- Make sure that we can construct and print an array using a pair index set
</span></div></div><div class="cell"><div class="code-block"><span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 2 <span class="symbol">&amp;</span> <span class="type-name">Fin</span> 2)<span class="symbol">.</span> 1<span class="symbol">.</span>0
</div><div class="result-block">[1.0, 1.0, 1.0, 1.0]@(Fin 2 &amp; Fin 2)</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block">1<span class="symbol">@</span>(<span class="type-name">Fin</span> 2 <span class="symbol">&amp;</span> <span class="type-name">Fin</span> 2)
</div><div class="result-block">(0@(Fin 2), 1@(Fin 2))</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 5)<span class="symbol">.</span> <span class="keyword">for</span> j<span class="symbol">:</span>(<span class="symbol">..</span>i)<span class="symbol">.</span>
  ir <span class="symbol">=</span> i2r <span class="symbol">$</span> ordinal i
  jr <span class="symbol">=</span> i2r <span class="symbol">$</span> ordinal j
  ir <span class="symbol">*</span> (ir <span class="symbol">+</span> 1<span class="symbol">.</span>0) <span class="symbol">/</span> 2<span class="symbol">.</span>0 <span class="symbol">+</span> jr
</div><div class="result-block">[ [0.0]@(..(0@Fin 5))
, [1.0, 2.0]@(..(1@Fin 5))
, [3.0, 4.0, 5.0]@(..(2@Fin 5))
, [6.0, 7.0, 8.0, 9.0]@(..(3@Fin 5))
, [10.0, 11.0, 12.0, 13.0, 14.0]@(..(4@Fin 5)) ]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- TODO: fix!
</span></div></div><div class="cell"><div class="code-block"><span class="comment">-- -- Exercise the use of free variables in the sum solver
</span></div></div><div class="cell"><div class="code-block"><span class="comment">-- :p
</span></div></div><div class="cell"><div class="code-block"><span class="comment">--   n = 2 + 2
</span></div></div><div class="cell"><div class="code-block"><span class="comment">--   x = for i:(Fin n). for j:(..i). 1.0
</span></div></div><div class="cell"><div class="code-block"><span class="comment">--   sum $ for i. sum x.i
</span></div></div><div class="cell"><div class="code-block"><span class="comment">-- &gt; 10.0
</span></div></div><div class="cell"><div class="code-block">

</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> 1 <span class="symbol">+</span> 2
</div><div class="result-block">3</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> [1<span class="symbol">,</span>2] <span class="symbol">-</span> [2<span class="symbol">,</span>10]
</div><div class="result-block">[-1, -8]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> 2<span class="symbol">.</span>0 <span class="symbol">.*</span> [[1<span class="symbol">.</span>0<span class="symbol">,</span> 2<span class="symbol">.</span>0]<span class="symbol">,</span> [3<span class="symbol">.</span>0<span class="symbol">,</span> 4<span class="symbol">.</span>0]]
</div><div class="result-block">[[2.0, 4.0], [6.0, 8.0]]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> newtonIter (f<span class="symbol">:</span> <span class="type-name">Real</span> <span class="symbol">-&gt;</span> <span class="type-name">Real</span>) (x<span class="symbol">:</span><span class="type-name">Real</span>) <span class="symbol">:</span> <span class="type-name">Real</span> <span class="symbol">=</span>
  x <span class="symbol">-</span> (f x <span class="symbol">/</span> deriv f x)
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> newtonSolve (tol<span class="symbol">:</span><span class="type-name">Real</span>) (f <span class="symbol">:</span> <span class="type-name">Real</span> <span class="symbol">-&gt;</span> <span class="type-name">Real</span>) (x0<span class="symbol">:</span><span class="type-name">Real</span>) <span class="symbol">:</span> <span class="type-name">Real</span> <span class="symbol">=</span>
  snd <span class="symbol">$</span> withState x0 <span class="symbol">\</span>x<span class="symbol">.</span>
    while (<span class="symbol">\</span>()<span class="symbol">.</span> abs (f <span class="symbol">$</span> get x) <span class="symbol">&gt;</span> tol) <span class="symbol">\</span>()<span class="symbol">.</span>
      x <span class="symbol">:=</span> newtonIter f <span class="symbol">$</span> get x
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> newtonSolve 0<span class="symbol">.</span>001 (<span class="symbol">\</span>x<span class="symbol">.</span> sq x <span class="symbol">-</span> 2<span class="symbol">.</span>0) 1<span class="symbol">.</span>0
</div><div class="result-block">1.4142157</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  x <span class="symbol">=</span> <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 3)<span class="symbol">.</span> <span class="keyword">for</span> j<span class="symbol">:</span>(<span class="type-name">Fin</span> 200)<span class="symbol">.</span> 1<span class="symbol">.</span>0
  <span class="comment">-- Last dimension split to allow for vector loads
</span>  y <span class="symbol">=</span> <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 200)<span class="symbol">.</span> <span class="keyword">for</span> j<span class="symbol">:</span>(<span class="type-name">Fin</span> 4)<span class="symbol">.</span> <span class="keyword">for</span> h<span class="symbol">:</span>(<span class="type-name">Fin</span> <span class="type-name">VectorWidth</span>)<span class="symbol">.</span> i2r <span class="symbol">$</span> (iota _)<span class="symbol">.</span>(i<span class="symbol">,</span>j<span class="symbol">,</span>h)
  z <span class="symbol">=</span> snd <span class="symbol">$</span> withAccum <span class="symbol">\</span>acc<span class="symbol">.</span>
        <span class="keyword">for</span> l<span class="symbol">.</span>
          <span class="keyword">for</span> i<span class="symbol">.</span>
            xil <span class="symbol">=</span> (broadcastVector x<span class="symbol">.</span>i<span class="symbol">.</span>l)
            <span class="keyword">for</span> j<span class="symbol">.</span>
              acc<span class="symbol">!</span>i<span class="symbol">!</span>j <span class="symbol">+=</span> xil <span class="symbol">*</span> (loadVector y<span class="symbol">.</span>l<span class="symbol">.</span>j)
  <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 3)<span class="symbol">.</span> <span class="keyword">for</span> j<span class="symbol">:</span>(<span class="type-name">Fin</span> 4)<span class="symbol">.</span> storeVector z<span class="symbol">.</span>i<span class="symbol">.</span>j
</div><div class="result-block">[ [ [318400.0, 318600.0, 318800.0, 319000.0]
, [319200.0, 319400.0, 319600.0, 319800.0]
, [320000.0, 320200.0, 320400.0, 320600.0]
, [320800.0, 321000.0, 321200.0, 321400.0] ]
, [ [318400.0, 318600.0, 318800.0, 319000.0]
, [319200.0, 319400.0, 319600.0, 319800.0]
, [320000.0, 320200.0, 320400.0, 320600.0]
, [320800.0, 321000.0, 321200.0, 321400.0] ]
, [ [318400.0, 318600.0, 318800.0, 319000.0]
, [319200.0, 319400.0, 319600.0, 319800.0]
, [320000.0, 320200.0, 320400.0, 320600.0]
, [320800.0, 321000.0, 321200.0, 321400.0] ] ]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  fs <span class="symbol">=</span> <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 4)<span class="symbol">.</span>
    x <span class="symbol">=</span> ordinal i
    <span class="symbol">\</span>y<span class="symbol">.</span> x <span class="symbol">+</span> y
  <span class="keyword">for</span> i<span class="symbol">.</span> fs<span class="symbol">.</span>i (ordinal i)
</div><div class="result-block">[0, 2, 4, 6]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  f <span class="symbol">=</span> fst <span class="symbol">$</span> withState 1 <span class="symbol">\</span>ref<span class="symbol">.</span>
    x <span class="symbol">=</span> get ref
    ref <span class="symbol">:=</span> 3 <span class="symbol">+</span> x
    y <span class="symbol">=</span> get ref
    <span class="symbol">\</span>z<span class="symbol">.</span> z <span class="symbol">+</span> 10 <span class="symbol">*</span> x <span class="symbol">+</span> 100 <span class="symbol">*</span> y
  f 5
</div><div class="result-block">415</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  (f<span class="symbol">,</span> w) <span class="symbol">=</span> withAccum <span class="symbol">\</span>ref<span class="symbol">.</span>
    ref <span class="symbol">+=</span> 2<span class="symbol">.</span>0
    w <span class="symbol">=</span> 2
    <span class="symbol">\</span>z<span class="symbol">.</span> z <span class="symbol">+</span> w
  (f 5<span class="symbol">,</span> w)
</div><div class="result-block">(7, 2.0)</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> add (n <span class="symbol">:</span> <span class="type-name">Type</span>) <span class="symbol">?-&gt;</span> (a <span class="symbol">:</span> n<span class="symbol">=&gt;</span><span class="type-name">Real</span>) (b <span class="symbol">:</span> n<span class="symbol">=&gt;</span><span class="type-name">Real</span>) <span class="symbol">:</span> n<span class="symbol">=&gt;</span><span class="type-name">Real</span> <span class="symbol">=</span>
  (tile (<span class="symbol">\</span>t<span class="symbol">:</span>(<span class="type-name">Tile</span> n (<span class="type-name">Fin</span> <span class="type-name">VectorWidth</span>))<span class="symbol">.</span> storeVector <span class="symbol">$</span> loadTile t a <span class="symbol">+</span> loadTile t b)
        (<span class="symbol">\</span>i<span class="command">:n</span><span class="symbol">.</span> a<span class="symbol">.</span>i <span class="symbol">+</span> b<span class="symbol">.</span>i))
</div></div><div class="cell"><div class="code-block">toAdd <span class="symbol">=</span> <span class="keyword">for</span> _<span class="symbol">:</span>(<span class="type-name">Fin</span> 10)<span class="symbol">.</span> 1<span class="symbol">.</span>0
</div></div><div class="cell"><div class="code-block">add toAdd toAdd
</div><div class="result-block">[2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block">arr2d <span class="symbol">=</span> <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 2)<span class="symbol">.</span> <span class="keyword">for</span> j<span class="symbol">:</span>(<span class="type-name">Fin</span> 2)<span class="symbol">.</span> (iota _)<span class="symbol">.</span>(i<span class="symbol">,</span>j)
</div></div><div class="cell"><div class="code-block">arr2d<span class="symbol">.</span>(1<span class="symbol">@</span>_)
</div><div class="result-block">[2, 3]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  withState (1<span class="symbol">,</span>2) <span class="symbol">\</span>ref<span class="symbol">.</span>
    r1 <span class="symbol">=</span> fstRef ref
    r2 <span class="symbol">=</span> sndRef ref
    x <span class="symbol">=</span> get r1
    y <span class="symbol">=</span> get r2
    r2 <span class="symbol">:=</span> x
    r1 <span class="symbol">:=</span> y
</div><div class="result-block">((), (2, 1))</div></div><div class="cell"><div class="code-block">

</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> any [<span class="type-name">True</span><span class="symbol">,</span> <span class="type-name">False</span>]
</div><div class="result-block">True</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> any [<span class="type-name">False</span><span class="symbol">,</span> <span class="type-name">False</span>]
</div><div class="result-block">False</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> any []<span class="symbol">:</span>(<span class="type-name">Fin</span> 0)<span class="symbol">=&gt;</span><span class="type-name">Bool</span>
</div><div class="result-block">False</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> all [<span class="type-name">True</span><span class="symbol">,</span> <span class="type-name">True</span>]
</div><div class="result-block">True</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> all [<span class="type-name">False</span><span class="symbol">,</span> <span class="type-name">True</span>]
</div><div class="result-block">False</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> all []<span class="symbol">:</span>(<span class="type-name">Fin</span> 0)<span class="symbol">=&gt;</span><span class="type-name">Bool</span>
</div><div class="result-block">True</div></div><div class="cell"><div class="code-block">

</div></div><div class="cell"><div class="prose-block"><p>Tests for numerical utilies</p>
</div></div><div class="cell"><div class="code-block">easy <span class="symbol">=</span> [(<span class="symbol">-</span>2<span class="symbol">.</span>0)<span class="symbol">,</span> 3<span class="symbol">.</span>0<span class="symbol">,</span> 3<span class="symbol">.</span>0<span class="symbol">,</span> 0<span class="symbol">.</span>1<span class="symbol">,</span> 0<span class="symbol">.</span>0]
</div></div><div class="cell"><div class="code-block">hard <span class="symbol">=</span> [(<span class="symbol">-</span>1000<span class="symbol">.</span>0)<span class="symbol">,</span> 1000<span class="symbol">.</span>0<span class="symbol">,</span> 1000<span class="symbol">.</span>0<span class="symbol">,</span> 0<span class="symbol">.</span>1<span class="symbol">,</span> 0<span class="symbol">.</span>0]
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> logsumexp easy <span class="symbol">-</span> (log <span class="symbol">$</span> sum <span class="keyword">for</span> j<span class="symbol">.</span> exp easy<span class="symbol">.</span>j)
</div><div class="result-block">0.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> sum <span class="symbol">$</span> softmax hard
</div><div class="result-block">1.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> all <span class="keyword">for</span> i<span class="symbol">.</span> ((softmax hard)<span class="symbol">.</span>i <span class="symbol">&gt;=</span> 0<span class="symbol">.</span>0)
</div><div class="result-block">True</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> sum <span class="keyword">for</span> i<span class="symbol">.</span> exp <span class="symbol">$</span> (logsoftmax hard)<span class="symbol">.</span>i
</div><div class="result-block">1.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> all <span class="keyword">for</span> i<span class="symbol">.</span> abs ((softmax hard)<span class="symbol">.</span>i <span class="symbol">-</span> exp (logsoftmax hard)<span class="symbol">.</span>i) <span class="symbol">&lt;</span> 0<span class="symbol">.</span>0000001
</div><div class="result-block">True</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> evalpoly [2<span class="symbol">.</span>0<span class="symbol">,</span> 3<span class="symbol">.</span>0<span class="symbol">,</span> 4<span class="symbol">.</span>0] 10<span class="symbol">.</span>0
</div><div class="result-block">234.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block">str <span class="symbol">=</span> [&#39;x&#39;<span class="symbol">,</span> &#39;y&#39;]
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> str
</div><div class="result-block">[&#39;x&#39;, &#39;y&#39;]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block">s1 <span class="symbol">=</span> &quot;hello world&quot;
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> s1
</div><div class="result-block">[&#39;h&#39;, &#39;e&#39;, &#39;l&#39;, &#39;l&#39;, &#39;o&#39;, &#39; &#39;, &#39;w&#39;, &#39;o&#39;, &#39;r&#39;, &#39;l&#39;, &#39;d&#39;]</div></div></div></body></html>