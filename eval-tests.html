<!DOCTYPE HTML>
<html><head><link rel="stylesheet" href="style.css" type="text/css"><meta charset="UTF-8"></head><body><div id="main-output"><div class="cell"><div class="code-block"><span class="command">:p</span> 1<span class="symbol">.</span>0 <span class="symbol">+</span> 2<span class="symbol">.</span>0
</div><div class="result-block">3.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
   double <span class="symbol">=</span> <span class="symbol">\</span>x<span class="symbol">.</span> x <span class="symbol">*</span> 2<span class="symbol">.</span>0
   double 10<span class="symbol">.</span>0
</div><div class="result-block">20.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> isum (iota (<span class="type-name">Fin</span> 10))
</div><div class="result-block">45</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
   x <span class="symbol">=</span> iota (<span class="type-name">Fin</span> 10)
   isum (<span class="keyword">for</span> i<span class="symbol">.</span> x<span class="symbol">.</span>i)
</div><div class="result-block">45</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
   vdot&#39; <span class="symbol">:</span> n<span class="symbol">:</span><span class="type-name">Type</span> <span class="symbol">?-&gt;</span> n<span class="symbol">=&gt;</span><span class="type-name">Real</span> <span class="symbol">-&gt;</span> n<span class="symbol">=&gt;</span><span class="type-name">Real</span> <span class="symbol">-&gt;</span> <span class="type-name">Real</span> <span class="symbol">=</span>
     <span class="symbol">\</span>x y<span class="symbol">.</span> sum (<span class="keyword">for</span> i<span class="symbol">.</span> x<span class="symbol">.</span>i <span class="symbol">*</span> y<span class="symbol">.</span>i <span class="symbol">*</span> 2<span class="symbol">.</span>0)
   x <span class="symbol">=</span> iota (<span class="type-name">Fin</span> 3)
   y <span class="symbol">=</span> map i2r x
   vdot&#39; y y
</div><div class="result-block">10.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
   x <span class="symbol">=</span> iota <span class="symbol">$</span> <span class="type-name">Fin</span> 3
   y <span class="symbol">=</span> iota <span class="symbol">$</span> <span class="type-name">Fin</span> 4
   z <span class="symbol">=</span> <span class="keyword">for</span> i j<span class="symbol">.</span> i2r x<span class="symbol">.</span>i <span class="symbol">*</span> i2r y<span class="symbol">.</span>j
   sum (<span class="keyword">for</span> i<span class="symbol">.</span> sum z<span class="symbol">.</span>i)
</div><div class="result-block">18.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- :p randint (hash 0 0) 10
</span></div></div><div class="cell"><div class="code-block"><span class="comment">-- :p let x = unpack range 10000
</span></div></div><div class="cell"><div class="code-block"><span class="comment">--        key = hash 0
</span></div></div><div class="cell"><div class="code-block"><span class="comment">--    in sum (for i: randint (key x.i) 10)
</span></div></div><div class="cell"><div class="code-block"><span class="type-name">NArr</span> <span class="symbol">=</span> <span class="type-name">Fin</span> 7
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block">arr <span class="symbol">=</span> iota <span class="type-name">NArr</span>
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> <span class="keyword">for</span> i<span class="symbol">:</span><span class="type-name">NArr</span><span class="symbol">.</span> iadd (iota _)<span class="symbol">.</span>i (iota _)<span class="symbol">.</span>i
</div><div class="result-block">[0, 2, 4, 6, 8, 10, 12]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> isum <span class="keyword">for</span> i<span class="symbol">:</span><span class="type-name">NArr</span><span class="symbol">.</span> 1
</div><div class="result-block">7</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block">fun <span class="symbol">=</span> <span class="symbol">\</span>y<span class="symbol">.</span> sum (map i2r arr) <span class="symbol">+</span> y
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> fun 3<span class="symbol">.</span>0
</div><div class="result-block">24.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> arr
</div><div class="result-block">[0, 1, 2, 3, 4, 5, 6]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> fold 0 <span class="symbol">\</span>i<span class="symbol">.</span> iadd arr<span class="symbol">.</span>i
</div><div class="result-block">21</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> 6<span class="symbol">.</span>0 <span class="symbol">-</span> 10<span class="symbol">.</span>0
</div><div class="result-block">-4.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> (<span class="symbol">\</span>(x<span class="symbol">,</span> y)<span class="symbol">.</span> x <span class="symbol">+</span> y) (1<span class="symbol">.</span>0<span class="symbol">,</span> 2<span class="symbol">.</span>0)
</div><div class="result-block">3.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
   f <span class="symbol">:</span> a<span class="symbol">:</span><span class="type-name">Type</span> <span class="symbol">?-&gt;</span> b<span class="symbol">:</span><span class="type-name">Type</span> <span class="symbol">?-&gt;</span> (a <span class="symbol">-&gt;</span> b <span class="symbol">&amp;</span> a) <span class="symbol">-&gt;</span> b <span class="symbol">=</span>
     <span class="symbol">\</span>(x<span class="symbol">,</span> y)<span class="symbol">.</span> x y
   f (<span class="symbol">\</span>x<span class="symbol">.</span> x<span class="symbol">,</span> 1)
</div><div class="result-block">1</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
   (x<span class="symbol">,</span>y) <span class="symbol">=</span> ((1<span class="symbol">.</span>0<span class="symbol">,</span>2<span class="symbol">.</span>0)<span class="symbol">,</span>3<span class="symbol">.</span>0)
   (x1<span class="symbol">,</span> x2) <span class="symbol">=</span> x
   x1 <span class="symbol">+</span> x2 <span class="symbol">+</span> y
</div><div class="result-block">6.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
   x <span class="symbol">=</span> (1<span class="symbol">.</span>0<span class="symbol">,</span>2<span class="symbol">.</span>0)
   (y<span class="symbol">,</span>z) <span class="symbol">=</span> x
   y <span class="symbol">+</span> z
</div><div class="result-block">3.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- :p let f (x, y) = x + 2 * y;
</span></div></div><div class="cell"><div class="code-block"><span class="comment">--        z.i = (x.i, x.i * x.i)
</span></div></div><div class="cell"><div class="code-block"><span class="comment">--    in sum (for i. f z.i)
</span></div></div><div class="cell"><div class="code-block"><span class="command">:p</span> exp 1<span class="symbol">.</span>0
</div><div class="result-block">2.7182817</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> log 1<span class="symbol">.</span>0
</div><div class="result-block">0.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> sqrt 2<span class="symbol">.</span>0
</div><div class="result-block">1.4142135</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> sin 3<span class="symbol">.</span>14159
</div><div class="result-block">2.6535897e-6</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> cos 0<span class="symbol">.</span>0
</div><div class="result-block">1.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> tan 1<span class="symbol">.</span>57079
</div><div class="result-block">158057.9</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block">s <span class="symbol">=</span> 1<span class="symbol">.</span>0
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> s
</div><div class="result-block">1.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> [2<span class="symbol">,</span> 4<span class="symbol">,</span> 8]
</div><div class="result-block">[2, 4, 8]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
   xs <span class="symbol">=</span> [2<span class="symbol">,</span>1<span class="symbol">,</span>0]
   <span class="keyword">for</span> i<span class="symbol">.</span> iadd xs<span class="symbol">.</span>i 10
</div><div class="result-block">[12, 11, 10]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block">cumsumplus <span class="symbol">:</span> n<span class="symbol">=&gt;</span><span class="type-name">Real</span> <span class="symbol">-&gt;</span> n<span class="symbol">=&gt;</span><span class="type-name">Real</span> <span class="symbol">=</span>
 <span class="symbol">\</span>xs<span class="symbol">.</span> snd <span class="symbol">$</span> scan 0<span class="symbol">.</span>0 <span class="symbol">\</span>i c<span class="symbol">.</span>
   ans <span class="symbol">=</span> c <span class="symbol">+</span> xs<span class="symbol">.</span>i
   (ans<span class="symbol">,</span> 1<span class="symbol">.</span>0 <span class="symbol">+</span> ans)
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> cumsumplus [1<span class="symbol">.</span>0<span class="symbol">,</span> 2<span class="symbol">.</span>0<span class="symbol">,</span> 3<span class="symbol">.</span>0]
</div><div class="result-block">[2.0, 4.0, 7.0]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> [<span class="type-name">False</span><span class="symbol">,</span> <span class="type-name">False</span><span class="symbol">,</span> <span class="type-name">True</span>]
</div><div class="result-block">[False, False, True]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> [<span class="type-name">False</span><span class="symbol">,</span> <span class="type-name">True</span><span class="symbol">,</span> <span class="type-name">True</span><span class="symbol">,</span> <span class="type-name">False</span>]  <span class="comment">-- testing again because it&#39;s been flaky
</span></div><div class="result-block">[False, True, True, False]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> (<span class="type-name">True</span><span class="symbol">,</span> <span class="type-name">False</span>)
</div><div class="result-block">(True, False)</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> 1<span class="symbol">.</span>0 <span class="symbol">&gt;</span> 2<span class="symbol">.</span>0
</div><div class="result-block">False</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> 1<span class="symbol">.</span>0 <span class="symbol">&gt;</span> neg 2<span class="symbol">.</span>0
</div><div class="result-block">True</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> 1<span class="symbol">.</span>0 <span class="symbol">&lt;</span> 2<span class="symbol">.</span>0
</div><div class="result-block">True</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> b2i (1<span class="symbol">.</span>0 <span class="symbol">&lt;</span> 2<span class="symbol">.</span>0)
</div><div class="result-block">1</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> [ 1 <span class="symbol">&lt;</span> 2<span class="symbol">,</span> 1<span class="symbol">.</span>0 <span class="symbol">&lt;</span> 2<span class="symbol">.</span>0<span class="symbol">,</span>  2 <span class="symbol">&lt;</span> 2<span class="symbol">,</span> 2<span class="symbol">.</span>0 <span class="symbol">&lt;</span> 2<span class="symbol">.</span>0<span class="symbol">,</span> 2 <span class="symbol">&lt;</span> 1<span class="symbol">,</span> 2<span class="symbol">.</span>0 <span class="symbol">&lt;</span> 1<span class="symbol">.</span>0]
</div><div class="result-block">[True, True, False, False, False, False]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> [ 1 <span class="symbol">&gt;</span> 2<span class="symbol">,</span> 1<span class="symbol">.</span>0 <span class="symbol">&gt;</span> 2<span class="symbol">.</span>0<span class="symbol">,</span>  2 <span class="symbol">&gt;</span> 2<span class="symbol">,</span> 2<span class="symbol">.</span>0 <span class="symbol">&gt;</span> 2<span class="symbol">.</span>0<span class="symbol">,</span> 2 <span class="symbol">&gt;</span> 1<span class="symbol">,</span> 2<span class="symbol">.</span>0 <span class="symbol">&gt;</span> 1<span class="symbol">.</span>0]
</div><div class="result-block">[False, False, False, False, True, True]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> [ 1 <span class="symbol">&lt;=</span> 2<span class="symbol">,</span> 1<span class="symbol">.</span>0 <span class="symbol">&lt;=</span> 2<span class="symbol">.</span>0<span class="symbol">,</span>  2 <span class="symbol">&lt;=</span> 2<span class="symbol">,</span> 2<span class="symbol">.</span>0 <span class="symbol">&lt;=</span> 2<span class="symbol">.</span>0<span class="symbol">,</span> 2 <span class="symbol">&lt;</span> 1<span class="symbol">,</span> 2<span class="symbol">.</span>0 <span class="symbol">&lt;</span> 1<span class="symbol">.</span>0]
</div><div class="result-block">[True, True, True, True, False, False]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> [ 1 <span class="symbol">&gt;=</span> 2<span class="symbol">,</span> 1<span class="symbol">.</span>0 <span class="symbol">&gt;=</span> 2<span class="symbol">.</span>0<span class="symbol">,</span>  2 <span class="symbol">&gt;=</span> 2<span class="symbol">,</span> 2<span class="symbol">.</span>0 <span class="symbol">&gt;=</span> 2<span class="symbol">.</span>0<span class="symbol">,</span> 2 <span class="symbol">&gt;=</span> 1<span class="symbol">,</span> 2<span class="symbol">.</span>0 <span class="symbol">&gt;=</span> 1<span class="symbol">.</span>0]
</div><div class="result-block">[False, False, True, True, True, True]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="type-name">N3</span> <span class="symbol">=</span> <span class="type-name">Fin</span> 3
</div></div><div class="cell"><div class="code-block"><span class="type-name">N4</span> <span class="symbol">=</span> <span class="type-name">Fin</span> 4
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block">mat <span class="symbol">=</span> <span class="keyword">for</span> i<span class="symbol">:</span><span class="type-name">N3</span> j<span class="symbol">:</span><span class="type-name">N4</span><span class="symbol">.</span> iadd (iota _)<span class="symbol">.</span>i (imul 10 (iota _)<span class="symbol">.</span>j)
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- :p isum for (i,j). mat.i.j
</span></div></div><div class="cell"><div class="code-block"><span class="comment">-- &gt; 192
</span></div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block">litArr <span class="symbol">=</span> [10<span class="symbol">,</span> 5<span class="symbol">,</span> 3]
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> mod 5 3
</div><div class="result-block">2</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> size (<span class="type-name">Fin</span> 3)
</div><div class="result-block">3</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 3)<span class="symbol">.</span> 1
</div><div class="result-block">[1, 1, 1]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
   (k<span class="symbol">,</span> _) <span class="symbol">=</span> (iadd 1 2<span class="symbol">,</span> 3)
   <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 6)<span class="symbol">.</span> iadd k (ordinal i)
</div><div class="result-block">[3, 4, 5, 6, 7, 8]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
   k <span class="symbol">=</span> newKey 0
   mean <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 100)<span class="symbol">.</span> randn (ixkey k i)
</div><div class="result-block">-0.115799494</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
   k <span class="symbol">=</span> newKey 0
   mean <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 100)<span class="symbol">.</span> sq <span class="symbol">$</span> randn (ixkey k i)
</div><div class="result-block">1.2581897</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 3) j<span class="symbol">:</span>(<span class="type-name">Fin</span> 2)<span class="symbol">.</span> rand <span class="symbol">$</span> ixkey2 (newKey 11) i j
</div><div class="result-block">[[0.47415292, 0.9145164], [0.7944602, 0.27679908], [0.58958626, 0.7116251]]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  x <span class="symbol">=</span> <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 3)<span class="symbol">.</span> 0
  x
</div><div class="result-block">[0, 0, 0]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
   x <span class="symbol">=</span> <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 3)<span class="symbol">.</span> <span class="keyword">for</span> j<span class="symbol">:</span>(<span class="type-name">Fin</span> 4)<span class="symbol">.</span> 0
   x
</div><div class="result-block">[[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> fold (<span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 3)<span class="symbol">.</span> 0<span class="symbol">.</span>0) <span class="symbol">$</span> <span class="symbol">\</span>i<span class="symbol">:</span>(<span class="type-name">Fin</span> 2) c<span class="symbol">.</span> (<span class="keyword">for</span> j<span class="symbol">.</span> c<span class="symbol">.</span>j <span class="symbol">+</span> i2r (ordinal j))
</div><div class="result-block">[0.0, 2.0, 4.0]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
   mat2 <span class="symbol">=</span> <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 4) j<span class="symbol">:</span>(<span class="type-name">Fin</span> 4) <span class="symbol">.</span> ordinal i
   tmp <span class="symbol">=</span> <span class="keyword">for</span> i<span class="symbol">.</span> mat2<span class="symbol">.</span>i<span class="symbol">.</span>i
   tmp
</div><div class="result-block">[0, 1, 2, 3]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  x <span class="symbol">=</span> [[0<span class="symbol">,</span> 1]<span class="symbol">,</span> [2<span class="symbol">,</span> 3]]
  xt <span class="symbol">=</span> <span class="keyword">for</span> i j<span class="symbol">.</span> x<span class="symbol">.</span>j<span class="symbol">.</span>i
  xt
</div><div class="result-block">[[0, 2], [1, 3]]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  (x<span class="symbol">,</span> y) <span class="symbol">=</span> (1<span class="symbol">,</span> (2<span class="symbol">,</span>3))
  (x<span class="symbol">,</span> y)
</div><div class="result-block">(1, (2, 3))</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 3)<span class="symbol">.</span> i
</div><div class="result-block">[0@(Fin 3), 1@(Fin 3), 2@(Fin 3)]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 3)<span class="symbol">.</span> i
</div><div class="result-block">[0@(Fin 3), 1@(Fin 3), 2@(Fin 3)]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> fromOrdinal (<span class="type-name">Fin</span> 1) 0
</div><div class="result-block">0@(Fin 1)</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- TODO: fix
</span></div></div><div class="cell"><div class="code-block"><span class="comment">-- :p [0].([asidx 0].(asidx 0))
</span></div></div><div class="cell"><div class="code-block"><span class="comment">-- &gt; 0
</span></div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> select <span class="type-name">True</span> 1 2
</div><div class="result-block">1</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> select <span class="type-name">False</span> 1<span class="symbol">.</span>0 2<span class="symbol">.</span>0
</div><div class="result-block">2.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> select <span class="type-name">True</span> [1<span class="symbol">,</span>2<span class="symbol">,</span>3] [10<span class="symbol">,</span>20<span class="symbol">,</span>30]
</div><div class="result-block">[1, 2, 3]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> select <span class="type-name">False</span> [1<span class="symbol">,</span>2<span class="symbol">,</span>3] [10<span class="symbol">,</span>20<span class="symbol">,</span>30]
</div><div class="result-block">[10, 20, 30]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> [(1<span class="symbol">,</span> (<span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 2) <span class="symbol">.</span> 3))]<span class="symbol">.</span>(fromOrdinal _ 0)
</div><div class="result-block">(1, [3, 3])</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> (<span class="type-name">False</span> <span class="symbol">&amp;&amp;</span> <span class="type-name">False</span><span class="symbol">,</span> <span class="type-name">False</span> <span class="symbol">&amp;&amp;</span> <span class="type-name">True</span><span class="symbol">,</span> <span class="type-name">True</span> <span class="symbol">&amp;&amp;</span> <span class="type-name">False</span><span class="symbol">,</span> <span class="type-name">True</span> <span class="symbol">&amp;&amp;</span> <span class="type-name">True</span>)
</div><div class="result-block">(False, (False, (False, True)))</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> (not <span class="type-name">False</span><span class="symbol">,</span> not <span class="type-name">True</span>)
</div><div class="result-block">(True, False)</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> (<span class="type-name">False</span> <span class="symbol">||</span> <span class="type-name">False</span><span class="symbol">,</span> <span class="type-name">False</span> <span class="symbol">||</span> <span class="type-name">True</span><span class="symbol">,</span> <span class="type-name">True</span> <span class="symbol">||</span> <span class="type-name">False</span><span class="symbol">,</span> <span class="type-name">True</span> <span class="symbol">||</span> <span class="type-name">True</span>)
</div><div class="result-block">(False, (True, (True, True)))</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> [(<span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 1)<span class="symbol">.</span> (<span class="type-name">False</span><span class="symbol">,</span> <span class="keyword">for</span> j<span class="symbol">:</span>(<span class="type-name">Fin</span> 2)<span class="symbol">.</span> 1<span class="symbol">.</span>0))<span class="symbol">,</span> [(<span class="type-name">True</span><span class="symbol">,</span> <span class="keyword">for</span> k<span class="symbol">:</span>(<span class="type-name">Fin</span> 2) <span class="symbol">.</span> 2<span class="symbol">.</span>0)]]
</div><div class="result-block">[[(False, [1.0, 1.0])], [(True, [2.0, 2.0])]]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- TODO: parse negative integer literals
</span></div></div><div class="cell"><div class="code-block"><span class="comment">-- :p (mod 5 3, mod 7 3, mod (-1) 3, mod -5 3)
</span></div></div><div class="cell"><div class="code-block"><span class="comment">-- &gt; (2, 1, 2, 1)
</span></div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> [[1<span class="symbol">,</span>2]<span class="symbol">,</span> <span class="keyword">for</span> i<span class="symbol">.</span> 3]
</div><div class="result-block">[[1, 2], [3, 3]]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> select <span class="type-name">False</span> [1<span class="symbol">,</span> 2] (<span class="keyword">for</span> i<span class="symbol">.</span> 3)
</div><div class="result-block">[3, 3]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> fold [1<span class="symbol">,</span> 2] <span class="symbol">\</span>i<span class="symbol">:</span>(<span class="type-name">Fin</span> 3) c<span class="symbol">.</span> <span class="keyword">for</span> j<span class="symbol">.</span> 4
</div><div class="result-block">[4, 4]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> select <span class="type-name">True</span> (1<span class="symbol">,</span>2) (2<span class="symbol">,</span>3)
</div><div class="result-block">(1, 2)</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> select <span class="type-name">False</span> (1<span class="symbol">,</span>[2<span class="symbol">,</span>3]) (4<span class="symbol">,</span> <span class="keyword">for</span> _ <span class="symbol">.</span> 3)
</div><div class="result-block">(4, [3, 3])</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> select <span class="type-name">False</span> () ()
</div><div class="result-block">()</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> [1<span class="symbol">,</span>2<span class="symbol">,</span>3]<span class="symbol">.</span>(fromOrdinal (<span class="type-name">Fin</span> 3) 1 )
</div><div class="result-block">2</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> fold (1<span class="symbol">.</span>0<span class="symbol">,</span> 2<span class="symbol">.</span>0) <span class="symbol">\</span>i<span class="symbol">:</span>(<span class="type-name">Fin</span> 2) (x<span class="symbol">,</span> y)<span class="symbol">.</span> (y<span class="symbol">,</span> x)
</div><div class="result-block">(1.0, 2.0)</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> fold (1<span class="symbol">.</span>0<span class="symbol">,</span> 2<span class="symbol">.</span>0) <span class="symbol">\</span>i<span class="symbol">:</span>(<span class="type-name">Fin</span> 3) (x<span class="symbol">,</span> y)<span class="symbol">.</span> (y<span class="symbol">,</span> x)
</div><div class="result-block">(2.0, 1.0)</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> id 2
</div><div class="result-block">2</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> min 2<span class="symbol">.</span>0 3<span class="symbol">.</span>0
</div><div class="result-block">2.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> minBy sq 0<span class="symbol">.</span>5 (<span class="symbol">-</span>2<span class="symbol">.</span>0)
</div><div class="result-block">0.5</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> minimum [2<span class="symbol">.</span>0<span class="symbol">,</span> 3<span class="symbol">.</span>0<span class="symbol">,</span> 4<span class="symbol">.</span>0<span class="symbol">,</span> 1<span class="symbol">.</span>5<span class="symbol">,</span> 7<span class="symbol">.</span>0]
</div><div class="result-block">1.5</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> minimumBy fst [(2<span class="symbol">.</span>0<span class="symbol">,</span> 20)<span class="symbol">,</span> (1<span class="symbol">.</span>5<span class="symbol">,</span> 15)<span class="symbol">,</span> (10<span class="symbol">.</span>0<span class="symbol">,</span> 100)]
</div><div class="result-block">(1.5, 15)</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> max 2<span class="symbol">.</span>0 3<span class="symbol">.</span>0
</div><div class="result-block">3.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> maxBy sq 0<span class="symbol">.</span>5 (<span class="symbol">-</span>2<span class="symbol">.</span>0)
</div><div class="result-block">-2.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> maximum [2<span class="symbol">.</span>0<span class="symbol">,</span> 4<span class="symbol">.</span>0<span class="symbol">,</span> 1<span class="symbol">.</span>5<span class="symbol">,</span> 7<span class="symbol">.</span>0]
</div><div class="result-block">7.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> maximumBy fst [(2<span class="symbol">.</span>0<span class="symbol">,</span> 20)<span class="symbol">,</span> (1<span class="symbol">.</span>5<span class="symbol">,</span> 15)<span class="symbol">,</span> (10<span class="symbol">.</span>0<span class="symbol">,</span> 100)]
</div><div class="result-block">(10.0, 100)</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- TODO: prefix negation for literals!
</span></div></div><div class="cell"><div class="code-block"><span class="comment">-- :p (1 == 2, -1 == -1, 1 &lt; 2, -1 &lt; 2, 2 &lt; -1)
</span></div></div><div class="cell"><div class="code-block"><span class="comment">-- &gt; (False, (True, (True, (True, False))))
</span></div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- :p (1. == 2., -1. == -1., 1. &lt; 2., -1. &lt; 2., 2. &lt; -1.)
</span></div></div><div class="cell"><div class="code-block"><span class="comment">-- &gt; (False, (True, (True, (True, False))))
</span></div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 7)<span class="symbol">.</span> select (i <span class="symbol">&lt;</span> (fromOrdinal _ 3)) 1 2
</div><div class="result-block">[1, 1, 1, 2, 2, 2, 2]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block">σ <span class="symbol">=</span> 1<span class="symbol">.</span>0 <span class="symbol">+</span> 2<span class="symbol">.</span>0
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> σ
</div><div class="result-block">3.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block">δ <span class="symbol">:</span> <span class="type-name">Int</span> <span class="symbol">-&gt;</span> <span class="type-name">Int</span> <span class="symbol">=</span> <span class="symbol">\</span>x<span class="symbol">.</span> x
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> δ 3
</div><div class="result-block">3</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> select <span class="type-name">True</span> 1 2
</div><div class="result-block">1</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> select <span class="type-name">True</span> [1<span class="symbol">,</span>2] [2<span class="symbol">,</span>3]
</div><div class="result-block">[1, 2]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> select <span class="type-name">True</span> (1<span class="symbol">,</span>2) (2<span class="symbol">,</span>3)
</div><div class="result-block">(1, 2)</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  x <span class="symbol">=</span> 1; x <span class="symbol">==</span> x
</div><div class="result-block">True</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> 1 `iadd` 2
</div><div class="result-block">3</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> slice [1<span class="symbol">,</span>2<span class="symbol">,</span>3<span class="symbol">,</span>4<span class="symbol">,</span>5] 2 (<span class="type-name">Fin</span> 3)
</div><div class="result-block">[3, 4, 5]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- TODO: test file specifically for parse errors (including testing error messages)
</span></div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
   f <span class="symbol">:</span> <span class="type-name">Real</span><span class="symbol">-&gt;</span><span class="type-name">Real</span> <span class="symbol">=</span> <span class="symbol">\</span>x<span class="symbol">.</span>
     <span class="comment">-- line comment should be ok here
</span>     2<span class="symbol">.</span>0 <span class="symbol">*</span> x
   f 1<span class="symbol">.</span>0
</div><div class="result-block">2.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- Not sure why the ordinary `sum/for` version doesn&#39;t work anymore
</span></div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
    n <span class="symbol">=</span> iadd 3 7
    fsum <span class="symbol">\</span>i<span class="symbol">:</span>(<span class="type-name">Fin</span> n)<span class="symbol">.</span> 1<span class="symbol">.</span>0
</div><div class="result-block">10.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
    n <span class="symbol">=</span> 4
    fsum <span class="symbol">\</span>i<span class="symbol">:</span>(<span class="type-name">Fin</span> n)<span class="symbol">.</span> 1<span class="symbol">.</span>0
</div><div class="result-block">4.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  one <span class="symbol">=</span> fromOrdinal (<span class="type-name">Fin</span> 4) 1
  <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 4)<span class="symbol">.</span> sum <span class="keyword">for</span> j<span class="symbol">:</span>(one<span class="symbol">..</span>i)<span class="symbol">.</span> 1<span class="symbol">.</span>0
</div><div class="result-block">[0.0, 1.0, 2.0, 3.0]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  one <span class="symbol">=</span> fromOrdinal (<span class="type-name">Fin</span> 4) 1
  <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 4)<span class="symbol">.</span> sum <span class="keyword">for</span> j<span class="symbol">:</span>(one<span class="symbol">&lt;..</span>i)<span class="symbol">.</span> 1<span class="symbol">.</span>0
</div><div class="result-block">[0.0, 0.0, 1.0, 2.0]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  one <span class="symbol">=</span> fromOrdinal (<span class="type-name">Fin</span> 4) 1
  <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 4)<span class="symbol">.</span> sum <span class="keyword">for</span> j<span class="symbol">:</span>(one<span class="symbol">&lt;..</span>i)<span class="symbol">.</span> 1<span class="symbol">.</span>0
</div><div class="result-block">[0.0, 0.0, 1.0, 2.0]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  one <span class="symbol">=</span> fromOrdinal (<span class="type-name">Fin</span> 4) 1
  <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 4)<span class="symbol">.</span> sum <span class="keyword">for</span> j<span class="symbol">:</span>(one<span class="symbol">..&lt;</span>i)<span class="symbol">.</span> 1<span class="symbol">.</span>0
</div><div class="result-block">[0.0, 0.0, 1.0, 2.0]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  one <span class="symbol">=</span> fromOrdinal (<span class="type-name">Fin</span> 4) 1
  <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 4)<span class="symbol">.</span> sum <span class="keyword">for</span> j<span class="symbol">:</span>(one<span class="symbol">&lt;..&lt;</span>i)<span class="symbol">.</span> 1<span class="symbol">.</span>0
</div><div class="result-block">[0.0, 0.0, 0.0, 1.0]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 4)<span class="symbol">.</span> sum <span class="keyword">for</span> j<span class="symbol">:</span>(<span class="symbol">..</span>i)<span class="symbol">.</span> 1<span class="symbol">.</span>0
</div><div class="result-block">[1.0, 2.0, 3.0, 4.0]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 4)<span class="symbol">.</span> sum <span class="keyword">for</span> j<span class="symbol">:</span>(<span class="symbol">..&lt;</span>i)<span class="symbol">.</span> 1<span class="symbol">.</span>0
</div><div class="result-block">[0.0, 1.0, 2.0, 3.0]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 4)<span class="symbol">.</span> sum <span class="keyword">for</span> j<span class="symbol">:</span>(i<span class="symbol">..</span>)<span class="symbol">.</span> 1<span class="symbol">.</span>0
</div><div class="result-block">[4.0, 3.0, 2.0, 1.0]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 4)<span class="symbol">.</span> sum <span class="keyword">for</span> j<span class="symbol">:</span>(i<span class="symbol">&lt;..</span>)<span class="symbol">.</span> 1<span class="symbol">.</span>0
</div><div class="result-block">[3.0, 2.0, 1.0, 0.0]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> idiv 10 3
</div><div class="result-block">3</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> rem 10 3
</div><div class="result-block">1</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  xs <span class="symbol">=</span> [10<span class="symbol">.,</span>20<span class="symbol">.</span>]
  ys <span class="symbol">=</span> [1<span class="symbol">.,</span>2<span class="symbol">.,</span>3<span class="symbol">.</span>]
  xys <span class="symbol">=</span> <span class="keyword">for</span> (i<span class="symbol">,</span>j)<span class="symbol">.</span> xs<span class="symbol">.</span>i <span class="symbol">+</span> ys<span class="symbol">.</span>j
  sum xys
</div><div class="result-block">102.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  xs <span class="symbol">=</span> [10<span class="symbol">.,</span>20<span class="symbol">.</span>]
  ys <span class="symbol">=</span> [1<span class="symbol">.,</span>2<span class="symbol">.,</span>3<span class="symbol">.</span>]
  zs <span class="symbol">=</span> [1<span class="symbol">.</span>]
  xys <span class="symbol">=</span> <span class="keyword">for</span> (i<span class="symbol">,</span>(j<span class="symbol">,</span>k))<span class="symbol">.</span> xs<span class="symbol">.</span>i <span class="symbol">+</span> ys<span class="symbol">.</span>j <span class="symbol">+</span> zs<span class="symbol">.</span>k
  sum xys
</div><div class="result-block">108.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  xs <span class="symbol">=</span> [[1<span class="symbol">,</span>2]<span class="symbol">,</span>[3<span class="symbol">,</span>4]]
  ys <span class="symbol">=</span> <span class="keyword">for</span> (i<span class="symbol">,</span>j)<span class="symbol">.</span> xs<span class="symbol">.</span>i<span class="symbol">.</span>j
  zs <span class="symbol">=</span> <span class="keyword">for</span> (i<span class="symbol">,</span>j)<span class="symbol">.</span> ys<span class="symbol">.</span>(i<span class="symbol">,</span>j)
  <span class="keyword">for</span> i j<span class="symbol">.</span> zs<span class="symbol">.</span>(j<span class="symbol">,</span>i)
</div><div class="result-block">[[1, 3], [2, 4]]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> argmin [1<span class="symbol">.</span>0<span class="symbol">,</span> 2<span class="symbol">.</span>0<span class="symbol">,</span> 0<span class="symbol">.</span>4<span class="symbol">,</span> 5<span class="symbol">.</span>0]
</div><div class="result-block">2@(Fin 4)</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> select <span class="type-name">True</span> (fromOrdinal (<span class="type-name">Fin</span> 2) 0) (fromOrdinal (<span class="type-name">Fin</span> 2) 1)
</div><div class="result-block">0@(Fin 2)</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- TODO: printing (also parsing) tables with alternative index sets
</span></div></div><div class="cell"><div class="code-block"><span class="comment">-- :p
</span></div></div><div class="cell"><div class="code-block"><span class="comment">--   xs = [[1],[2]]
</span></div></div><div class="cell"><div class="code-block"><span class="comment">--   for (i,j). xs.i.j
</span></div></div><div class="cell"><div class="code-block"><span class="comment">-- &gt; [1, 2]@(2, 1)
</span></div></div><div class="cell"><div class="code-block">

</div></div><div class="cell"><div class="code-block"><span class="comment">-- TODO: injections
</span></div></div><div class="cell"><div class="code-block"><span class="comment">-- :p
</span></div></div><div class="cell"><div class="code-block"><span class="comment">--   xs = for i:5. 1.0
</span></div></div><div class="cell"><div class="code-block"><span class="comment">--   two = fromOrdinal (Fin 5) 2
</span></div></div><div class="cell"><div class="code-block"><span class="comment">--   for i:3. sum for j:(two&lt;..). xs.(%inject(j))
</span></div></div><div class="cell"><div class="code-block"><span class="comment">-- &gt; [2.0, 2.0, 2.0]
</span></div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  withState 0<span class="symbol">.</span>0 <span class="symbol">\</span>ref<span class="symbol">.</span> <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 4)<span class="symbol">.</span>
      c <span class="symbol">=</span> get ref
      ref <span class="symbol">:=</span> c <span class="symbol">+</span> 1<span class="symbol">.</span>0
      c
</div><div class="result-block">([0.0, 1.0, 2.0, 3.0], 4.0)</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  withState 0<span class="symbol">.</span>0 <span class="symbol">\</span>ref<span class="symbol">.</span> <span class="keyword">rof</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 4)<span class="symbol">.</span>
      c <span class="symbol">=</span> get ref
      ref <span class="symbol">:=</span> c <span class="symbol">+</span> 1<span class="symbol">.</span>0
      c
</div><div class="result-block">([3.0, 2.0, 1.0, 0.0], 4.0)</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> eitherFloor (x<span class="symbol">:</span><span class="type-name">Int</span><span class="symbol">|</span><span class="type-name">Real</span>) <span class="symbol">:</span> <span class="type-name">Int</span> <span class="symbol">=</span> <span class="keyword">case</span> x
  <span class="type-name">Left</span> i  <span class="symbol">-&gt;</span> i
  <span class="type-name">Right</span> f <span class="symbol">-&gt;</span> floor f
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> eitherFloor (<span class="type-name">Right</span> 1<span class="symbol">.</span>2)
</div><div class="result-block">1</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  x <span class="symbol">:</span> <span class="type-name">Int</span><span class="symbol">|</span><span class="type-name">Real</span> <span class="symbol">=</span> <span class="type-name">Right</span> 1<span class="symbol">.</span>2
  x
</div><div class="result-block">(Right 1.2)</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- Sum types as flattened index sets!
</span></div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> <span class="type-name">Weights</span> (n<span class="symbol">:</span><span class="type-name">Type</span>) (m<span class="symbol">:</span><span class="type-name">Type</span>) <span class="symbol">:</span> <span class="type-name">Type</span> <span class="symbol">=</span> n<span class="symbol">=&gt;</span>m<span class="symbol">=&gt;</span><span class="type-name">Real</span>
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> <span class="type-name">Biases</span>  (n<span class="symbol">:</span><span class="type-name">Type</span>)          <span class="symbol">:</span> <span class="type-name">Type</span> <span class="symbol">=</span> n<span class="symbol">=&gt;</span><span class="type-name">Real</span>
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> <span class="type-name">Params</span>  (n<span class="symbol">:</span><span class="type-name">Type</span>) (m<span class="symbol">:</span><span class="type-name">Type</span>) <span class="symbol">:</span> <span class="type-name">Type</span> <span class="symbol">=</span> ((n<span class="symbol">&amp;</span>m)<span class="symbol">|</span>n)<span class="symbol">=&gt;</span><span class="type-name">Real</span>
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block">w <span class="symbol">=</span> <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 2)<span class="symbol">.</span> <span class="keyword">for</span> j<span class="symbol">:</span>(<span class="type-name">Fin</span> 3)<span class="symbol">.</span> (i2r (ordinal i)) <span class="symbol">*</span> 3<span class="symbol">.</span>0 <span class="symbol">+</span> (i2r (ordinal j))
</div></div><div class="cell"><div class="code-block">b <span class="symbol">=</span> <span class="keyword">for</span> j<span class="symbol">:</span>(<span class="type-name">Fin</span> 2)<span class="symbol">.</span> neg (i2r (ordinal j) <span class="symbol">+</span> 1<span class="symbol">.</span>0)
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> flatten ((w<span class="symbol">,</span>b)<span class="symbol">:</span>(<span class="type-name">Weights</span> n m <span class="symbol">&amp;</span> <span class="type-name">Biases</span> n))<span class="symbol">:</span> <span class="type-name">Params</span> n m <span class="symbol">=</span>
  <span class="keyword">for</span> idx<span class="symbol">.</span> <span class="keyword">case</span> idx
    <span class="type-name">Left</span> (i<span class="symbol">,</span>j) <span class="symbol">-&gt;</span> w<span class="symbol">.</span>i<span class="symbol">.</span>j
    <span class="type-name">Right</span> i    <span class="symbol">-&gt;</span> b<span class="symbol">.</span>i
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> unflatten (params<span class="symbol">:</span><span class="type-name">Params</span> n m) <span class="symbol">:</span> (<span class="type-name">Weights</span> n m <span class="symbol">&amp;</span> <span class="type-name">Biases</span> n) <span class="symbol">=</span>
  ( <span class="keyword">for</span> i<span class="symbol">.</span> <span class="keyword">for</span> j<span class="symbol">.</span> params<span class="symbol">.</span>(<span class="type-name">Left</span> (i<span class="symbol">,</span>j))
  <span class="symbol">,</span> <span class="keyword">for</span> i<span class="symbol">.</span>        params<span class="symbol">.</span>(<span class="type-name">Right</span> i)    )
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> unflatten (flatten (w<span class="symbol">,</span> b)) <span class="symbol">==</span> (w<span class="symbol">,</span> b)
</div><div class="result-block">True</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> [1<span class="symbol">,</span>2<span class="symbol">,</span>3] <span class="symbol">==</span> [1<span class="symbol">,</span>2<span class="symbol">,</span>3]
</div><div class="result-block">True</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> [1<span class="symbol">,</span>2<span class="symbol">,</span>4] <span class="symbol">==</span> [1<span class="symbol">,</span>2<span class="symbol">,</span>3]
</div><div class="result-block">False</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> (1<span class="symbol">,</span> 2) <span class="symbol">==</span> (1<span class="symbol">,</span> 2)
</div><div class="result-block">True</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> (<span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 4)<span class="symbol">.</span> (1<span class="symbol">.</span>0<span class="symbol">,</span> ordinal i)) <span class="symbol">==</span> (<span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 4)<span class="symbol">.</span> (1<span class="symbol">.</span>0<span class="symbol">,</span> ordinal i))
</div><div class="result-block">True</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> (1<span class="symbol">,</span> 1) <span class="symbol">==</span> (1<span class="symbol">,</span> 2)
</div><div class="result-block">False</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> (<span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 4)<span class="symbol">.</span> 1<span class="symbol">.</span>0) <span class="symbol">==</span> (<span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 4)<span class="symbol">.</span> 2<span class="symbol">.</span>0)
</div><div class="result-block">False</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- Needed to avoid ambiguous type variables if both sides use the same constructor
</span></div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> cmpEither (x<span class="symbol">:</span><span class="type-name">Int</span><span class="symbol">|</span><span class="type-name">Int</span>) (y<span class="symbol">:</span><span class="type-name">Int</span><span class="symbol">|</span><span class="type-name">Int</span>) <span class="symbol">:</span> <span class="type-name">Bool</span> <span class="symbol">=</span> x <span class="symbol">==</span> y
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> cmpEither (<span class="type-name">Left</span> 1) (<span class="type-name">Left</span> 1)
</div><div class="result-block">True</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> cmpEither (<span class="type-name">Left</span> 1) (<span class="type-name">Left</span> 2)
</div><div class="result-block">False</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> cmpEither (<span class="type-name">Left</span> 1) (<span class="type-name">Right</span> 1)
</div><div class="result-block">False</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- TODO: within-module version of this (currently fails in Imp checking)
</span></div></div><div class="cell"><div class="code-block">upperBound <span class="symbol">=</span> isum <span class="symbol">$</span> <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 4)<span class="symbol">.</span> 1
</div></div><div class="cell"><div class="code-block"><span class="keyword">for</span> j<span class="symbol">:</span>(<span class="type-name">Fin</span> upperBound)<span class="symbol">.</span> 1<span class="symbol">.</span>0
</div><div class="result-block">[1.0, 1.0, 1.0, 1.0]@(Fin aget Int[1])</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block">(<span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> upperBound)<span class="symbol">.</span> 1<span class="symbol">,</span> <span class="keyword">for</span> j<span class="symbol">:</span>(<span class="type-name">Fin</span> 2)<span class="symbol">.</span> 2)
</div><div class="result-block">([1, 1, 1, 1]@(Fin aget Int[1]), [2, 2])</div></div></div></body></html>