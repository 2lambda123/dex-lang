<!DOCTYPE HTML>
<html><head><link rel="stylesheet" href="style.css" type="text/css"><meta charset="UTF-8"></head><body><div id="main-output"><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- TODO: use prelude sum instead once we can differentiate state effect
</span></div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> sum&#39;  (xs<span class="command">:n</span><span class="symbol">=&gt;</span><span class="type-name">Real</span>) <span class="symbol">:</span> <span class="type-name">Real</span> <span class="symbol">=</span> snd <span class="symbol">$</span> withAccum <span class="symbol">\</span>ref<span class="symbol">.</span> <span class="keyword">for</span> i<span class="symbol">.</span> ref <span class="symbol">+=</span> xs<span class="symbol">.</span>i
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
   f <span class="symbol">:</span> <span class="type-name">Real</span> <span class="symbol">-&gt;</span> <span class="type-name">Real</span> <span class="symbol">=</span> <span class="symbol">\</span>x<span class="symbol">.</span> x
   jvp f 3<span class="symbol">.</span>0 2<span class="symbol">.</span>0
</div><div class="result-block">2.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
   f <span class="symbol">=</span> <span class="symbol">\</span>x<span class="symbol">.</span> x <span class="symbol">*</span> x
   jvp f 3<span class="symbol">.</span>0 1<span class="symbol">.</span>5
</div><div class="result-block">9.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
   f <span class="symbol">=</span> <span class="symbol">\</span>x<span class="symbol">.</span> x <span class="symbol">+</span> x
   jvp f 3<span class="symbol">.</span>0 2<span class="symbol">.</span>0
</div><div class="result-block">4.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
   f <span class="symbol">=</span> <span class="symbol">\</span>x<span class="symbol">.</span> x <span class="symbol">*</span> x <span class="symbol">*</span> x
   jvp f 2<span class="symbol">.</span>0 1<span class="symbol">.</span>5
</div><div class="result-block">18.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
   f <span class="symbol">:</span> <span class="type-name">Real</span> <span class="symbol">--</span>o <span class="type-name">Real</span> <span class="symbol">=</span> <span class="symbol">\</span>x<span class="symbol">.</span> x
   transposeLinear f 2<span class="symbol">.</span>0
</div><div class="result-block">2.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
   f <span class="symbol">:</span> <span class="type-name">Real</span> <span class="symbol">--</span>o <span class="type-name">Real</span> <span class="symbol">=</span> <span class="symbol">\</span>x<span class="symbol">.</span> x <span class="symbol">+</span> x
   transposeLinear f 1<span class="symbol">.</span>0
</div><div class="result-block">2.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
   f <span class="symbol">:</span> <span class="type-name">Real</span> <span class="symbol">--</span>o <span class="type-name">Real</span> <span class="symbol">=</span> <span class="symbol">\</span>x<span class="symbol">.</span> x <span class="symbol">+</span> (x <span class="symbol">+</span> x) <span class="symbol">*</span> 2<span class="symbol">.</span>0
   transposeLinear f 1<span class="symbol">.</span>0
</div><div class="result-block">5.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
   f <span class="symbol">:</span> <span class="type-name">Real</span> <span class="symbol">--</span>o <span class="type-name">Real</span> <span class="symbol">=</span> <span class="symbol">\</span>x<span class="symbol">.</span> x <span class="symbol">*</span> 2<span class="symbol">.</span>0
   transposeLinear f 1<span class="symbol">.</span>0
</div><div class="result-block">2.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
   f <span class="symbol">:</span> <span class="type-name">Real</span> <span class="symbol">--</span>o <span class="type-name">Real</span> <span class="symbol">=</span> <span class="symbol">\</span>x<span class="symbol">.</span> 2<span class="symbol">.</span>0 <span class="symbol">*</span> x
   transposeLinear f 1<span class="symbol">.</span>0
</div><div class="result-block">2.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> grad (<span class="symbol">\</span>x<span class="symbol">.</span> x <span class="symbol">*</span> x) 1<span class="symbol">.</span>0
</div><div class="result-block">2.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> deriv (<span class="symbol">\</span>x<span class="symbol">.</span> 3<span class="symbol">.</span>0 <span class="symbol">/</span> x) 2<span class="symbol">.</span>0
</div><div class="result-block">-0.75</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> deriv (<span class="symbol">\</span>x<span class="symbol">.</span> x <span class="symbol">/</span> 2<span class="symbol">.</span>0) 3<span class="symbol">.</span>0
</div><div class="result-block">0.5</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  f <span class="symbol">:</span> n<span class="symbol">:</span><span class="type-name">Type</span> <span class="symbol">?-&gt;</span> n<span class="symbol">=&gt;</span><span class="type-name">Real</span> <span class="symbol">-&gt;</span> n<span class="symbol">=&gt;</span><span class="type-name">Real</span> <span class="symbol">=</span>
   <span class="symbol">\</span>xs<span class="symbol">.</span> <span class="keyword">for</span> i<span class="symbol">.</span> xs<span class="symbol">.</span>i <span class="symbol">*</span> xs<span class="symbol">.</span>i

  jvp f [1<span class="symbol">.,</span>2<span class="symbol">.</span>] [3<span class="symbol">.,</span>4<span class="symbol">.</span>]
</div><div class="result-block">[6.0, 16.0]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> jvp transpose [[1<span class="symbol">.,</span>2<span class="symbol">.</span>]<span class="symbol">,</span> [3<span class="symbol">.,</span>4<span class="symbol">.</span>]] [[10<span class="symbol">.,</span>20<span class="symbol">.</span>]<span class="symbol">,</span> [30<span class="symbol">.,</span>40<span class="symbol">.</span>]]
</div><div class="result-block">[[10.0, 30.0], [20.0, 40.0]]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> jvp sum&#39; [1<span class="symbol">.,</span> 2<span class="symbol">.</span>] [10<span class="symbol">.</span>0<span class="symbol">,</span> 20<span class="symbol">.</span>0]
</div><div class="result-block">30.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block">f <span class="symbol">:</span> <span class="type-name">Real</span> <span class="symbol">-&gt;</span> <span class="type-name">Real</span> <span class="symbol">=</span> <span class="symbol">\</span>x<span class="symbol">.</span> snd <span class="symbol">$</span> withAccum <span class="symbol">\</span>ref<span class="symbol">.</span> ref <span class="symbol">+=</span> x
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> jvp f 1<span class="symbol">.</span>0 1<span class="symbol">.</span>0
</div><div class="result-block">1.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
   f <span class="symbol">=</span> <span class="symbol">\</span>x<span class="symbol">.</span> x <span class="symbol">*</span> x <span class="symbol">*</span> x
   jvp (<span class="symbol">\</span>x<span class="symbol">.</span> jvp f x 1<span class="symbol">.</span>0) 2<span class="symbol">.</span>0 1<span class="symbol">.</span>0
</div><div class="result-block">12.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
   f <span class="symbol">=</span> <span class="symbol">\</span>x<span class="symbol">.</span> 4<span class="symbol">.</span>0 <span class="symbol">*</span> x <span class="symbol">*</span> x <span class="symbol">*</span> x
   deriv (deriv (deriv f)) 1<span class="symbol">.</span>234
</div><div class="result-block">24.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- TODO: handle pairs and re-enable
</span></div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
   f <span class="symbol">:</span> <span class="type-name">Real</span> <span class="symbol">--</span>o (<span class="type-name">Real</span> <span class="symbol">&amp;</span> <span class="type-name">Real</span>) <span class="symbol">=</span> <span class="symbol">\</span>x<span class="symbol">.</span> (x<span class="symbol">,</span> 2<span class="symbol">.</span>0 <span class="symbol">*</span> x)
   transposeLinear f (1<span class="symbol">.</span>0<span class="symbol">,</span> 3<span class="symbol">.</span>0)
</div><div class="result-block">7.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- TODO: handle pairs and re-enable
</span></div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
   f <span class="symbol">:</span> (<span class="type-name">Real</span> <span class="symbol">&amp;</span> <span class="type-name">Real</span>) <span class="symbol">--</span>o <span class="type-name">Real</span> <span class="symbol">=</span> <span class="symbol">\</span>(x<span class="symbol">,</span>y)<span class="symbol">.</span> x <span class="symbol">+</span> 2<span class="symbol">.</span>0 <span class="symbol">*</span> y
   transposeLinear f 1<span class="symbol">.</span>0
</div><div class="result-block">(1.0, 2.0)</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- TODO: handle user-defined linearity rules an re-enable
</span></div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- :p deriv cos 0.0
</span></div></div><div class="cell"><div class="code-block"><span class="comment">-- &gt; 0.0
</span></div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- :p deriv sin 0.0
</span></div></div><div class="cell"><div class="code-block"><span class="comment">-- &gt; 1.0
</span></div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- :p (sin 1.0, deriv (deriv sin) 1.0)
</span></div></div><div class="cell"><div class="code-block"><span class="comment">-- &gt; (0.84147096, -0.84147096)
</span></div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- :p (cos 1.0, deriv (deriv (deriv sin)) 1.0)
</span></div></div><div class="cell"><div class="code-block"><span class="comment">-- &gt; (0.5403023, -0.5403023)
</span></div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- :p checkDeriv sin 1.0
</span></div></div><div class="cell"><div class="code-block"><span class="comment">-- &gt; True
</span></div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- :p checkDeriv cos 1.0
</span></div></div><div class="cell"><div class="code-block"><span class="comment">-- &gt; True
</span></div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- :p checkDeriv exp 2.0
</span></div></div><div class="cell"><div class="code-block"><span class="comment">-- &gt; True
</span></div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- :p checkDeriv log 2.0
</span></div></div><div class="cell"><div class="code-block"><span class="comment">-- &gt; True
</span></div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- :p checkDeriv sqrt 2.0
</span></div></div><div class="cell"><div class="code-block"><span class="comment">-- &gt; True
</span></div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- :p checkDeriv (\x. cos (sin (exp x))) 2.0
</span></div></div><div class="cell"><div class="code-block"><span class="comment">-- &gt; True
</span></div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- :p checkDeriv (deriv sin) 1.0
</span></div></div><div class="cell"><div class="code-block"><span class="comment">-- &gt; True
</span></div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- :p checkDeriv (deriv cos) 1.0
</span></div></div><div class="cell"><div class="code-block"><span class="comment">-- &gt; True
</span></div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- badDerivFun : Real -&gt; Real
</span></div></div><div class="cell"><div class="code-block"><span class="comment">-- badDerivFun x = x
</span></div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- badDerivFun#lin : Real -&gt; (Real, Real --o Real)
</span></div></div><div class="cell"><div class="code-block"><span class="comment">-- badDerivFun#lin x = (x, llam t. 2. * t)
</span></div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- :p checkDeriv badDerivFun 1.0
</span></div></div><div class="cell"><div class="code-block"><span class="comment">-- &gt; False
</span></div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- Perturbation confusion test suggested by Barak Pearlmutter
</span></div></div><div class="cell"><div class="code-block"><span class="comment">-- https://github.com/HIPS/autograd/issues/4
</span></div></div><div class="cell"><div class="code-block"><span class="command">:p</span> deriv (<span class="symbol">\</span>x<span class="symbol">.</span> x <span class="symbol">*</span> deriv (<span class="symbol">\</span>y<span class="symbol">.</span> x <span class="symbol">*</span> y) 2<span class="symbol">.</span>0) 1<span class="symbol">.</span>0
</div><div class="result-block">2.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- sinn#lin : Real -&gt; Real
</span></div></div><div class="cell"><div class="code-block"><span class="comment">-- sinn#lin x = x
</span></div></div><div class="cell"><div class="code-block"><span class="comment">-- &gt; Error: variable not in scope: sinn
</span></div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block">tripleit <span class="symbol">:</span> <span class="type-name">Real</span> <span class="symbol">--</span>o <span class="type-name">Real</span> <span class="symbol">=</span> <span class="symbol">\</span>x<span class="symbol">.</span> x <span class="symbol">+</span> x <span class="symbol">+</span> x
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> tripleit 1<span class="symbol">.</span>0
</div><div class="result-block">3.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> transposeLinear tripleit 1<span class="symbol">.</span>0
</div><div class="result-block">3.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> transposeLinear (transposeLinear tripleit) 1<span class="symbol">.</span>0
</div><div class="result-block">3.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  f <span class="symbol">:</span> n<span class="symbol">:</span><span class="type-name">Type</span> <span class="symbol">?-&gt;</span>  <span class="type-name">Real</span> <span class="symbol">--</span>o n<span class="symbol">=&gt;</span><span class="type-name">Real</span> <span class="symbol">=</span> <span class="symbol">\</span>x<span class="symbol">.</span> <span class="keyword">for</span> i<span class="symbol">.</span> x

  transposeLinear f [1<span class="symbol">.</span>0<span class="symbol">,</span> 2<span class="symbol">.</span>0]
</div><div class="result-block">3.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  f <span class="symbol">:</span> n<span class="symbol">:</span><span class="type-name">Type</span> <span class="symbol">?-&gt;</span> n<span class="symbol">=&gt;</span><span class="type-name">Real</span> <span class="symbol">--</span>o n<span class="symbol">=&gt;</span><span class="type-name">Real</span> <span class="symbol">=</span> <span class="symbol">\</span>x<span class="symbol">.</span> <span class="keyword">for</span> i<span class="symbol">.</span> x<span class="symbol">.</span>i <span class="symbol">*</span> 2<span class="symbol">.</span>0

  transposeLinear f [1<span class="symbol">.</span>0<span class="symbol">,</span> 2<span class="symbol">.</span>0]
</div><div class="result-block">[2.0, 4.0]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block">myOtherSquare <span class="symbol">:</span> <span class="type-name">Real</span> <span class="symbol">-&gt;</span> <span class="type-name">Real</span> <span class="symbol">=</span>
  <span class="symbol">\</span>x<span class="symbol">.</span> snd <span class="symbol">$</span> withAccum <span class="symbol">\</span>w<span class="symbol">.</span> w <span class="symbol">+=</span> x <span class="symbol">*</span> x
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> myOtherSquare 3<span class="symbol">.</span>0
</div><div class="result-block">9.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> jvp myOtherSquare 3<span class="symbol">.</span>0 1<span class="symbol">.</span>0
</div><div class="result-block">6.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> transposeLinear (jvp myOtherSquare 3<span class="symbol">.</span>0) 1<span class="symbol">.</span>0
</div><div class="result-block">6.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  f <span class="symbol">:</span> <span class="type-name">Real</span> <span class="symbol">-&gt;</span> <span class="type-name">Real</span> <span class="symbol">=</span>
    <span class="symbol">\</span>x<span class="symbol">.</span> fst (x <span class="symbol">*</span> x<span class="symbol">,</span> 2 <span class="symbol">+</span> 1)

  jvp f 1<span class="symbol">.</span>0 3<span class="symbol">.</span>0
</div><div class="result-block">6.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  f <span class="symbol">:</span> <span class="type-name">Real</span> <span class="symbol">-&gt;</span> <span class="type-name">Real</span> <span class="symbol">=</span> <span class="symbol">\</span>x<span class="symbol">.</span>
    x <span class="symbol">*</span> i2r (1 <span class="symbol">+</span> 1)

  jvp f 1<span class="symbol">.</span>0 2<span class="symbol">.</span>0
</div><div class="result-block">4.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  f <span class="symbol">:</span> (<span class="type-name">Fin</span> 2)<span class="symbol">=&gt;</span><span class="type-name">Real</span> <span class="symbol">-&gt;</span> <span class="type-name">Real</span> <span class="symbol">=</span>
    <span class="symbol">\</span>xs<span class="symbol">.</span> xs<span class="symbol">.</span>(0 <span class="symbol">@</span> <span class="type-name">Fin</span> 2) <span class="symbol">*</span> xs<span class="symbol">.</span>(1 <span class="symbol">@</span> <span class="type-name">Fin</span> 2)

  jvp f [1<span class="symbol">.,</span> 2<span class="symbol">.</span>] [3<span class="symbol">.</span>0<span class="symbol">,</span> 4<span class="symbol">.</span>0]
</div><div class="result-block">10.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  f <span class="symbol">:</span> (<span class="type-name">Real</span> <span class="symbol">&amp;</span> <span class="type-name">Real</span>) <span class="symbol">-&gt;</span> <span class="type-name">Real</span> <span class="symbol">=</span>
    <span class="symbol">\</span>(x<span class="symbol">,</span>y)<span class="symbol">.</span> x <span class="symbol">*</span> y

  jvp f (1<span class="symbol">.,</span> 2<span class="symbol">.</span>) (3<span class="symbol">.</span>0<span class="symbol">,</span> 4<span class="symbol">.</span>0)
</div><div class="result-block">10.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  f <span class="symbol">:</span> n<span class="symbol">:</span><span class="type-name">Type</span> <span class="symbol">?-&gt;</span> n<span class="symbol">=&gt;</span><span class="type-name">Real</span> <span class="symbol">-&gt;</span> n<span class="symbol">=&gt;</span><span class="type-name">Real</span> <span class="symbol">=</span>
    <span class="symbol">\</span>xs<span class="symbol">.</span> <span class="keyword">for</span> i<span class="symbol">.</span> xs<span class="symbol">.</span>i <span class="symbol">*</span> xs<span class="symbol">.</span>i

  jvp f [1<span class="symbol">.,</span>2<span class="symbol">.</span>] [3<span class="symbol">.,</span>4<span class="symbol">.</span>]
</div><div class="result-block">[6.0, 16.0]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> jvp sum&#39; [1<span class="symbol">.,</span> 2<span class="symbol">.</span>] [3<span class="symbol">.</span>0<span class="symbol">,</span> 4<span class="symbol">.</span>0]
</div><div class="result-block">7.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> grad sum&#39; [1<span class="symbol">.,</span>2<span class="symbol">.</span>]
</div><div class="result-block">[1.0, 1.0]</div></div><div class="cell"><div class="code-block">

</div></div><div class="cell"><div class="code-block">vec <span class="symbol">=</span> [1<span class="symbol">.</span>]
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> jvp (<span class="symbol">\</span>x<span class="symbol">.</span> vec) [1<span class="symbol">.</span>] [1<span class="symbol">.</span>]
</div><div class="result-block">[0.0]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> grad (<span class="symbol">\</span>(x<span class="symbol">,</span> y)<span class="symbol">.</span> vdot x y) ([1<span class="symbol">.,</span>2<span class="symbol">.</span>]<span class="symbol">,</span> [3<span class="symbol">.,</span>4<span class="symbol">.</span>])
</div><div class="result-block">([3.0, 4.0], [1.0, 2.0])</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  f <span class="symbol">:</span> <span class="type-name">Real</span> <span class="symbol">-&gt;</span> <span class="type-name">Real</span> <span class="symbol">=</span> <span class="symbol">\</span>x<span class="symbol">.</span>
    y <span class="symbol">=</span> x <span class="symbol">*</span> 2<span class="symbol">.</span>0
    snd <span class="symbol">$</span> withAccum <span class="symbol">\</span>a<span class="symbol">.</span>
      a <span class="symbol">+=</span> x <span class="symbol">*</span> 2<span class="symbol">.</span>0
      a <span class="symbol">+=</span> y
  grad f 1<span class="symbol">.</span>0
</div><div class="result-block">4.0</div></div></div></body></html>