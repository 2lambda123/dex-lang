<!DOCTYPE HTML>
<html><head><link rel="stylesheet" href="style.css" type="text/css"><meta charset="UTF-8"></head><body><div id="main-output"><div class="cell"><div class="prose-block"><h1>Monte Carlo estimates of pi</h1>
</div></div><div class="cell"><div class="code-block">estimatePiArea <span class="symbol">::</span> <span class="type-name">Key</span> <span class="symbol">-</span><span class="symbol">&gt;</span> <span class="type-name">Real</span>
estimatePiArea key <span class="symbol">=</span>
  (k1, k2) <span class="symbol">=</span> splitKey key
  x <span class="symbol">=</span> rand k1
  y <span class="symbol">=</span> rand k2
  inBounds <span class="symbol">=</span> sq x <span class="symbol">+</span> sq y <span class="symbol">&lt;</span> 1<span class="symbol">.</span>0
  4<span class="symbol">.</span>0 <span class="symbol">*</span> b2r inBounds
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block">estimatePiAvgVal <span class="symbol">::</span> <span class="type-name">Key</span> <span class="symbol">-</span><span class="symbol">&gt;</span> <span class="type-name">Real</span>
estimatePiAvgVal key <span class="symbol">=</span>
  x <span class="symbol">=</span> rand key
  4<span class="symbol">.</span>0 <span class="symbol">*</span> sqrt (1<span class="symbol">.</span>0 <span class="symbol">-</span> sq x)
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block">meanAndStdDev <span class="symbol">::</span> <span class="keyword">A </span>n<span class="symbol">.</span> (<span class="type-name">Key</span> <span class="symbol">-</span><span class="symbol">&gt;</span> <span class="type-name">Real</span>) <span class="symbol">-</span><span class="symbol">&gt;</span> <span class="type-name">Key</span> <span class="symbol">-</span><span class="symbol">&gt;</span> (<span class="type-name">Real</span>, <span class="type-name">Real</span>)
meanAndStdDev f key <span class="symbol">=</span>
  samps <span class="symbol">=</span> many <span class="symbol">@</span>n f key
  (mean samps, std samps)
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">type</span> <span class="type-name">NumSamps</span> <span class="symbol">=</span> 1000000
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> meanAndStdDev <span class="symbol">@</span><span class="type-name">NumSamps</span> estimatePiArea 0
</div><div class="result-block">(3.143024, 1.6411874163007711)</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> meanAndStdDev <span class="symbol">@</span><span class="type-name">NumSamps</span> estimatePiAvgVal 0
</div><div class="result-block">(3.1417837281469603, 0.892754742618003)</div></div></div></body></html>