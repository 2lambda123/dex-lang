<!DOCTYPE HTML>
<html><head><link rel="stylesheet" href="style.css" type="text/css"><meta charset="UTF-8"></head><body><div id="main-output"><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> 3 <span class="symbol">+</span> (4 <span class="symbol">+</span> 5)
</div><div class="result-block">12</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> depId (a<span class="symbol">:</span><span class="type-name">Type</span>) (x<span class="command">:a</span>) <span class="symbol">:</span> a <span class="symbol">=</span> x
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> depId <span class="type-name">Int</span> 1
</div><div class="result-block">1</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> returnFirstArg (a<span class="symbol">:</span><span class="type-name">Type</span>) (b<span class="symbol">:</span><span class="type-name">Type</span>) (x<span class="command">:a</span>) (y<span class="command">:b</span>) <span class="symbol">:</span> a <span class="symbol">=</span> x
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> returnFirstArg <span class="type-name">Int</span> <span class="type-name">Real</span> 1 2<span class="symbol">.</span>0
</div><div class="result-block">1</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> 1<span class="symbol">.</span>0 <span class="symbol">+</span> 2<span class="symbol">.</span>0
</div><div class="result-block">3.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> triple (x<span class="symbol">:</span><span class="type-name">Real</span>) <span class="symbol">:</span> <span class="type-name">Real</span> <span class="symbol">=</span> x <span class="symbol">+</span> x <span class="symbol">+</span> x
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> triple 1<span class="symbol">.</span>0
</div><div class="result-block">3.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> idExplicit (a<span class="symbol">:</span><span class="type-name">Type</span>) (x<span class="command">:a</span>) <span class="symbol">:</span> a <span class="symbol">=</span> x
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> idExplicit <span class="type-name">Int</span> 1
</div><div class="result-block">1</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> idImplicit (a<span class="symbol">:</span><span class="type-name">Type</span>) <span class="symbol">?-&gt;</span> (x<span class="command">:a</span>) <span class="symbol">:</span> a <span class="symbol">=</span> x
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> idImplicit 1
</div><div class="result-block">1</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block">idImplicit2 <span class="symbol">:</span> (a<span class="symbol">:</span><span class="type-name">Type</span> <span class="symbol">?-&gt;</span> a <span class="symbol">-&gt;</span> a) <span class="symbol">=</span> <span class="symbol">\</span>x<span class="symbol">.</span> x
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> idImplicit2 1
</div><div class="result-block">1</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  idImplicit3 <span class="symbol">:</span> (a<span class="symbol">:</span><span class="type-name">Type</span> <span class="symbol">?-&gt;</span> a <span class="symbol">-&gt;</span> a) <span class="symbol">=</span> <span class="symbol">\</span>x<span class="symbol">.</span> x
  idImplicit3 1
</div><div class="result-block">1</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> (<span class="symbol">\</span>x y<span class="symbol">.</span> x <span class="symbol">+</span> y) 1<span class="symbol">.</span>0 2<span class="symbol">.</span>0
</div><div class="result-block">3.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> 1<span class="symbol">.</span>0 <span class="symbol">+</span> 1
</div><div class="err-block">Type error:
Expected: Real
  Actual: Int

:p 1.0 + 1
         ^
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> 1 <span class="symbol">+</span> (1<span class="symbol">.</span>0 <span class="symbol">+</span> 2<span class="symbol">.</span>0)
</div><div class="err-block">Type error:
Expected: Int
  Actual: Real

:p 1 + (1.0 + 2.0)
        ^^^^^^^^^
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> 1<span class="symbol">.</span>0 <span class="symbol">+</span> (2 <span class="symbol">+</span> 3)
</div><div class="err-block">Type error:
Expected: Real
  Actual: Int

:p 1.0 + (2 + 3)
          ^^^^^
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> x <span class="symbol">+</span> x
</div><div class="err-block">Error: variable not in scope: x

:p x + x
   ^^
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block">idiv <span class="symbol">=</span> 1
</div><div class="err-block">Error: variable already defined: idiv</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> <span class="type-name">TyId</span> (a<span class="symbol">:</span><span class="type-name">Type</span>) <span class="symbol">:</span> <span class="type-name">Type</span> <span class="symbol">=</span> a
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  x<span class="symbol">:</span>(<span class="type-name">TyId</span> <span class="type-name">Int</span>) <span class="symbol">=</span> 1
  x
</div><div class="result-block">1</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  <span class="keyword">def</span> <span class="type-name">TyId2</span> (a<span class="symbol">:</span><span class="type-name">Type</span>) <span class="symbol">:</span> <span class="type-name">Type</span> <span class="symbol">=</span> a
  x<span class="symbol">:</span>(<span class="type-name">TyId2</span> <span class="type-name">Int</span>) <span class="symbol">=</span> 1
  x
</div><div class="result-block">1</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> tabId (n<span class="symbol">:</span><span class="type-name">Type</span>) <span class="symbol">?-&gt;</span> (x<span class="command">:n</span><span class="symbol">=&gt;</span><span class="type-name">Int</span>) <span class="symbol">:</span> n<span class="symbol">=&gt;</span><span class="type-name">Int</span> <span class="symbol">=</span> <span class="keyword">for</span> i<span class="symbol">.</span> x<span class="symbol">.</span>i
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- bug: this doesn&#39;t work if we split it across top-level decls
</span></div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  xs <span class="symbol">=</span> <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 3) <span class="symbol">.</span> 1
  tabId xs
</div><div class="result-block">[1, 1, 1]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block">myPair <span class="symbol">=</span> (1<span class="symbol">,</span> 2<span class="symbol">.</span>3)
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> fst myPair
</div><div class="result-block">1</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
   snd <span class="symbol">$</span> withState 2 <span class="symbol">\</span>s<span class="symbol">.</span>
     x <span class="symbol">=</span> get s
     s <span class="symbol">:=</span> x <span class="symbol">+</span> 3
</div><div class="result-block">5</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
   snd <span class="symbol">$</span> withState 1 <span class="symbol">\</span>s<span class="symbol">.</span>
     <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 10)<span class="symbol">.</span>
       x <span class="symbol">=</span> get s
       s <span class="symbol">:=</span> x <span class="symbol">+</span> x
</div><div class="result-block">1024</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
 x<span class="symbol">:</span><span class="type-name">Unit</span> <span class="symbol">=</span> ()
 x
</div><div class="result-block">()</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> [1<span class="symbol">,</span>2<span class="symbol">,</span>3]
</div><div class="result-block">[1, 2, 3]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> [] <span class="symbol">:</span> <span class="type-name">Fin</span> 0 <span class="symbol">=&gt;</span> <span class="type-name">Int</span>
</div><div class="result-block">[]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> sin 1<span class="symbol">.</span>0
</div><div class="result-block">0.84147096</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  (x<span class="symbol">,</span>y) <span class="symbol">=</span> (1<span class="symbol">,</span>2)
  (x<span class="symbol">,</span>y)
</div><div class="result-block">(1, 2)</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  (x<span class="symbol">,</span>y<span class="symbol">,</span>z) <span class="symbol">=</span> (1<span class="symbol">,</span>2<span class="symbol">,</span>3)
  (x<span class="symbol">,</span>y<span class="symbol">,</span>z)
</div><div class="result-block">(1, (2, 3))</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  ((x<span class="symbol">,</span>y)<span class="symbol">,</span>z) <span class="symbol">=</span> (1<span class="symbol">,</span>2<span class="symbol">,</span>3)
  ((x<span class="symbol">,</span>y)<span class="symbol">,</span>z)
</div><div class="err-block">Type error:
Expected: (a &amp; b)
  Actual: Int
(Solving for: [a:Type, b:Type])

  ((x,y),z) = (1,2,3)
    ^^^
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  (x<span class="symbol">,</span>(y<span class="symbol">,</span>z)) <span class="symbol">=</span> (1<span class="symbol">,</span>2<span class="symbol">,</span>3)
  (x<span class="symbol">,</span>(y<span class="symbol">,</span>z))
</div><div class="result-block">(1, (2, 3))</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  (x<span class="symbol">,</span>y) <span class="symbol">=</span> 1
  (x<span class="symbol">,</span>y)
</div><div class="err-block">Type error:
Expected: (a &amp; b)
  Actual: Int
(Solving for: [a:Type, b:Type])

  (x,y) = 1
   ^^^
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  snd <span class="symbol">$</span> withState [1<span class="symbol">,</span>2<span class="symbol">,</span>3] <span class="symbol">\</span>xsRef<span class="symbol">.</span>
    <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 3)<span class="symbol">.</span>
      xsRef<span class="symbol">!</span>i <span class="symbol">:=</span> ordinal i
</div><div class="result-block">[0, 1, 2]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> passthrough (eff<span class="symbol">:</span><span class="type-name">Effects</span>) <span class="symbol">?-&gt;</span> (f<span class="symbol">:</span>(a <span class="symbol">-&gt;</span> {<span class="symbol">|</span>eff} b)) (x<span class="command">:a</span>) <span class="symbol">:</span> {<span class="symbol">|</span>eff} b <span class="symbol">=</span> f x
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  snd <span class="symbol">$</span> withState 1 <span class="symbol">\</span>ref<span class="symbol">.</span>
    passthrough (<span class="symbol">\</span>()<span class="symbol">.</span> ref <span class="symbol">:=</span> 10) ()
</div><div class="result-block">10</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  withState 0 <span class="symbol">\</span>r1<span class="symbol">.</span>
    withState 0 <span class="symbol">\</span>r2<span class="symbol">.</span>
      r1 <span class="symbol">:=</span> 1
      r2 <span class="symbol">:=</span> 2
</div><div class="result-block">(((), 2), 1)</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> (<span class="symbol">\</span>f x y<span class="symbol">.</span> f x y) (<span class="symbol">+</span>) 1<span class="symbol">.</span>0 2<span class="symbol">.</span>0
</div><div class="result-block">3.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  myId <span class="symbol">=</span> fst (<span class="symbol">\</span>x<span class="symbol">.</span> x<span class="symbol">,</span> 2)
  f <span class="symbol">:</span> a<span class="symbol">:</span><span class="type-name">Type</span> <span class="symbol">-&gt;</span> a <span class="symbol">-&gt;</span> a <span class="symbol">=</span> <span class="symbol">\</span>a<span class="symbol">.</span> <span class="symbol">\</span>x<span class="symbol">.</span> myId x
  f <span class="type-name">Int</span> 1
</div><div class="err-block">Type error:Leaked type variable: a:Type

  f : a:Type -&gt; a -&gt; a = \a. \x. myId x
                          ^^^^^^^^^^^^^
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> myFst (p<span class="command">:a</span><span class="symbol">&amp;</span>b) <span class="symbol">:</span> a <span class="symbol">=</span>
  (x<span class="symbol">,</span> _) <span class="symbol">=</span> p
  x
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> myFst (1<span class="symbol">,</span>2)
</div><div class="result-block">1</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> myOtherFst ((x<span class="symbol">,</span> _)<span class="command">:a</span><span class="symbol">&amp;</span>b) <span class="symbol">:</span> a <span class="symbol">=</span> x
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> myOtherFst (1<span class="symbol">,</span>2)
</div><div class="result-block">1</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> sum [1<span class="symbol">.,</span>2<span class="symbol">.</span>]
</div><div class="result-block">3.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
  xs <span class="symbol">=</span> fanout _ 1<span class="symbol">.</span>0
  <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 3)<span class="symbol">.</span> xs<span class="symbol">.</span>i <span class="symbol">+</span> xs<span class="symbol">.</span>i
</div><div class="result-block">[2.0, 2.0, 2.0]</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
   f <span class="symbol">=</span> <span class="symbol">\</span>x<span class="symbol">.</span> x <span class="symbol">*</span> x <span class="symbol">*</span> x
   jvp f 2<span class="symbol">.</span>0 1<span class="symbol">.</span>5
</div><div class="result-block">18.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
   f <span class="symbol">:</span> <span class="type-name">Real</span> <span class="symbol">--</span>o <span class="type-name">Real</span> <span class="symbol">=</span>
     <span class="symbol">\</span>x<span class="symbol">.</span> 2<span class="symbol">.</span>0 <span class="symbol">*</span> (x <span class="symbol">+</span> x)
   transposeLinear f 1<span class="symbol">.</span>0
</div><div class="result-block">4.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- FIXME: This fails due to shadowing!
</span></div></div><div class="cell"><div class="code-block"><span class="symbol">--</span><span class="keyword">def</span> transpose&#39; (x<span class="command">:n</span><span class="symbol">=&gt;</span>m<span class="symbol">=&gt;</span><span class="type-name">Real</span>) <span class="symbol">--</span>o <span class="symbol">:</span> m<span class="symbol">=&gt;</span>n<span class="symbol">=&gt;</span><span class="type-name">Real</span> <span class="symbol">=</span> <span class="keyword">for</span> i j<span class="symbol">.</span> x<span class="symbol">.</span>j<span class="symbol">.</span>i
</div></div><div class="cell"><div class="code-block"><span class="symbol">--</span>
</div></div><div class="cell"><div class="code-block"><span class="symbol">--:</span>p transposeLinear transpose&#39; [[1<span class="symbol">.</span>0<span class="symbol">,</span> 2<span class="symbol">.</span>0<span class="symbol">,</span> 3<span class="symbol">.</span>0]]
</div></div><div class="cell"><div class="code-block"><span class="symbol">--&gt;</span> [[1<span class="symbol">.</span>0]<span class="symbol">,</span> [2<span class="symbol">.</span>0]<span class="symbol">,</span> [3<span class="symbol">.</span>0]]
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span>
   f <span class="symbol">:</span> <span class="type-name">Real</span> <span class="symbol">--</span>o (<span class="type-name">Fin</span> 3<span class="symbol">=&gt;</span><span class="type-name">Real</span>) <span class="symbol">=</span>
     <span class="symbol">\</span>x<span class="symbol">.</span> <span class="keyword">for</span> i<span class="symbol">.</span> x <span class="symbol">*</span> 2<span class="symbol">.</span>0
   transposeLinear f [1<span class="symbol">.</span>0<span class="symbol">,</span> 2<span class="symbol">.</span>0<span class="symbol">,</span> 3<span class="symbol">.</span>0]
</div><div class="result-block">12.0</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block">id&#39;&#39; <span class="symbol">:</span> b <span class="symbol">-&gt;</span> b <span class="symbol">=</span> id
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> eitherFloor (x<span class="symbol">:</span>(<span class="type-name">Int</span><span class="symbol">|</span><span class="type-name">Real</span>)) <span class="symbol">:</span> <span class="type-name">Int</span> <span class="symbol">=</span> <span class="keyword">oldcase</span> x
  <span class="type-name">Left</span>  i <span class="symbol">-&gt;</span> i
  <span class="type-name">Right</span> f <span class="symbol">-&gt;</span> floor f
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:p</span> (eitherFloor (<span class="type-name">Left</span> 1)<span class="symbol">,</span> eitherFloor (<span class="type-name">Right</span> 2<span class="symbol">.</span>3))
</div><div class="result-block">(1, 2)</div></div></div></body></html>