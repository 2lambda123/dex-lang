<!DOCTYPE HTML>
<html><head><meta charset="UTF-8"><style type="text/css">/* Copyright 2019 Google LLC                              */
/*                                                        */
/* Use of this source code is governed by a BSD-style     */
/* license that can be found in the LICENSE file or at    */
/* https://developers.google.com/open-source/licenses/bsd */

body {
  font-family: Helvetica, sans-serif;
  font-size: 100%;
  color: #333;
  display: flex;
  justify-content: space-between;
  overflow-x: hidden;

  --main-width: 50rem;
  --nav-width: 20rem;
}

@media (max-width: 70rem) {
    /*For narrow screens hide nav and enable horizontal scrolling */
    nav {display: none;}
    body {overflow-x: auto;}
}

nav {/* this actually just holds space for #navbar, which is fixed */
  min-width: var(--nav-width);
  max-width: var(--nav-width);
}
#navbar {
  position: fixed;
  height: 100vh;
  width: var(--nav-width);
  overflow-y: scroll;
  border-right: 1px solid firebrick;
}
#navbar:before {
  content: "Contents";
  font-weight: bold;
}
nav ol {
  list-style-type:none;
  padding-left: 1rem;
}

#main-output {
  max-width: var(--main-width);
  margin: auto;
}

.cell {
}

.code-block, .err-block, .result-block {
  padding: 0em 0em 0em 2em;
  display: block;
  font-family: monospace;
  white-space: pre;
}

code {
  background-color: #F0F0F0;
}

.result-block {
  border-left: 3px solid  #87CEFA;
}

.prose-block {
  line-height: 140%;
}

.err-block {
  font-weight: bold;
  color: #B22222;
  border-left: 3px solid #B22222;
}

.plot {
  padding: 5em;
}

.plot-img {
  width: 80%;
}

.comment {
  color: #808080;
}

.keyword {
  color: #0000DD;
}

.command {
  color: #A80000;
}

.symbol {
  color: #E07000;
}

.type-name {
  color: #A80000;
}

.iso-sugar {
  color: #25BBA7;
}
</style><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"><script defer="" src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js"></script><script defer="" src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" onload="// Copyright 2019 Google LLC
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file or at
// https://developers.google.com/open-source/licenses/bsd

var katexOptions = {
    delimiters: [
        {left: &quot;$$&quot;, right: &quot;$$&quot;, display: true},
        {left: &quot;\\[&quot;, right: &quot;\\]&quot;, display: true},
        {left: &quot;$&quot;, right: &quot;$&quot;, display: false},
        {left: &quot;\\(&quot;, right: &quot;\\)&quot;, display: false}
    ],
    // Enable commands that load resources or change HTML attributes
    // (e.g. hyperlinks): https://katex.org/docs/security.html.
    trust: true
};

var cells = {};

function append_contents(key, contents) {
    if (key in cells) {
        var cur_cells = cells[key];
    } else {
        var cell = document.createElement(&quot;div&quot;);
        cell.className = &quot;cell&quot;;
        cells[key] = [cell];
        var cur_cells = [cell];
    }
    for (var i = 0; i &lt; contents.length; i++) {
        for (var j = 0; j &lt; cur_cells.length; j++) {
            var node = lookup_address(cur_cells[j], contents[i][0])
            node.innerHTML += contents[i][1];
        }
    }
}

function lookup_address(cell, address) {
    var node = cell
    for (i = 0; i &lt; address.length; i++) {
        node = node.children[address[i]]
    }
    return node
}

function renderLaTeX() {
    // Render LaTeX equations in prose blocks via KaTeX, if available.
    // Skip rendering if KaTeX is unavailable.
    if (typeof renderMathInElement == &#39;undefined&#39;) {
        return;
    }
    // Render LaTeX equations in prose blocks via KaTeX.
    var proseBlocks = document.querySelectorAll(&quot;.prose-block&quot;);
    Array.from(proseBlocks).map((proseBlock) =&gt;
        renderMathInElement(proseBlock, katexOptions)
    );
}

/**
 * Rendering the Table of Contents / Navigation Bar
 * 2 key functions
 *  - `updateNavigation()` which inserts/updates the navigation bar
 *  - and it&#39;s helper `extractStructure()` which extracts the structure of the page
 *    and adds ids to heading elements.
*/
function updateNavigation() {
    function navItemList(struct) {
        var listEle = document.createElement(&#39;ol&#39;)
        struct.children.forEach(childStruct=&gt;
            listEle.appendChild(navItem(childStruct))
        );
        return listEle;
    }
    function navItem(struct) {
        var a = document.createElement(&#39;a&#39;);
        a.appendChild(document.createTextNode(struct.text));
        a.title = struct.text;
        a.href = &quot;#&quot;+struct.id;

        var ele = document.createElement(&#39;li&#39;)
        ele.appendChild(a)
        ele.appendChild(navItemList(struct));
        return ele;
    }

    var navbarEle = document.getElementById(&quot;navbar&quot;)
    if (navbarEle === null) {  // create it
        navbarEle = document.createElement(&quot;div&quot;);
        navbarEle.id=&quot;navbar&quot;;
        navOuterEle = document.createElement(&quot;nav&quot;)
        navOuterEle.appendChild(navbarEle);
        document.body.prepend(navOuterEle);
    }

    navbarEle.innerHTML = &quot;&quot;
    var structure = extractStructure()
    navbarEle.appendChild(navItemList(structure));
}

function extractStructure() { // Also sets ids on h1,h2,...
    var headingsNodes = document.querySelectorAll(&quot;h1, h2, h3, h4, h5, h6&quot;);
    // For now we are just fulling going to regenerate the structure each time
    // Might be better if we made minimal changes, but ðŸ¤·

    // Extract the structure of the document
    var structure = {children:[]}
    var active = [structure.children];
    headingsNodes.forEach(
        function(currentValue, currentIndex) {
            currentValue.id = &quot;s-&quot; + currentIndex;
            var currentLevel = parseInt(currentValue.nodeName[1]);

            // Insert dummy levels up for any levels that are skipped
            for (var i=active.length; i &lt; currentLevel; i++) {
                var dummy = {id: &quot;&quot;, text: &quot;&quot;, children: []}
                active.push(dummy.children);
                var parentList = active[i-1]
                parentList.push(dummy);
            }
            // delete this level and everything after
            active.splice(currentLevel, active.length);

            var currentStructure = {
                id: currentValue.id,
                text: currentValue.textContent,
                children: [],
            };
            active.push(currentStructure.children);

            var parentList = active[active.length-2]
            parentList.push(currentStructure);
        },
    );
    return structure;
}

/**
 * HTML rendering mode.
 * Static rendering is used for static HTML pages.
 * Dynamic rendering is used for dynamic HTML pages via `dex web`.
 *
 * @enum {string}
 */
var RENDER_MODE = Object.freeze({
  STATIC: &quot;static&quot;,
  DYNAMIC: &quot;dynamic&quot;,
})

/**
 * Renders the webpage.
 * @param {RENDER_MODE} renderMode The render mode, either static or dynamic.
 */
function render(renderMode) {
    if (renderMode == RENDER_MODE.STATIC) {
        // For static pages, simply call rendering functions once.
        renderLaTeX();
        updateNavigation();
    } else {
        // For dynamic pages (via `dex web`), listen to update events.
        var source = new EventSource(&quot;/getnext&quot;);
        source.onmessage = function(event) {
            var body = document.getElementById(&quot;main-output&quot;);
            var msg = JSON.parse(event.data);
            if (msg == &quot;start&quot;) {
                body.innerHTML = &quot;&quot;;
                cells = {}
                return
            }
            var order    = msg[0];
            var contents = msg[1];
            for (var i = 0; i &lt; contents.length; i++) {
                append_contents(contents[i][0], contents[i][1]);
            }
            if (order != null) {
                var new_cells = {};
                body.innerHTML = &quot;&quot;;
                for (var i = 0; i &lt; order.val.length; i++) {
                    var key = order.val[i]
                    var cur_cells = cells[key]
                    if (cur_cells.length == 0) {
                        var cur_cell = new_cells[key][0].cloneNode(true)
                    } else {
                        var cur_cell = cur_cells.pop()
                        if (key in new_cells) {
                            new_cells[key].push(cur_cell);
                        } else {
                            new_cells[key] = [cur_cell];
                        }
                    }
                    body.appendChild(cur_cell);
                }
                Object.assign(cells, new_cells);
            }
            renderLaTeX();
            updateNavigation();
        };
    }
}
render(RENDER_MODE.STATIC);"></script></head><body><div id="main-output"><div class="cell"><div class="code-block"></div></div><div class="cell"><div class="prose-block"><h2>Fluid sim</h2>
<p>Fluid simulation code based on
<a href="https://www.josstam.com/publications">Real-Time Fluid Dynamics for Games</a> by Jos Stam</p>
</div></div><div class="cell"><div class="code-block"><span class="keyword">import</span> png
</div></div><div class="cell"><div class="code-block"><span class="keyword">import</span> plot
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> wrapidx (n<span class="symbol">:</span><span class="type-name">Type</span>) [<span class="type-name">Ix</span> n] (i<span class="symbol">:</span><span class="type-name">Int</span>) <span class="symbol">:</span> n <span class="symbol">=</span>
  <span class="comment">-- Index wrapping around at ends.
</span>  asidx <span class="symbol">$</span> unsafe_i_to_n <span class="symbol">$</span> mod i <span class="symbol">$</span> n_to_i <span class="symbol">$</span> size n
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> incwrap {n} [<span class="type-name">Ix</span> n] (i<span class="command">:n</span>) <span class="symbol">:</span> n <span class="symbol">=</span>  <span class="comment">-- Increment index, wrapping around at ends.
</span>  asidx <span class="symbol">$</span> unsafe_i_to_n <span class="symbol">$</span> mod ((n_to_i <span class="symbol">$</span> ordinal i) <span class="symbol">+</span> 1) <span class="symbol">$</span> n_to_i <span class="symbol">$</span> size n
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> decwrap {n} [<span class="type-name">Ix</span> n] (i<span class="command">:n</span>) <span class="symbol">:</span> n <span class="symbol">=</span>  <span class="comment">-- Decrement index, wrapping around at ends.
</span>  asidx <span class="symbol">$</span> unsafe_i_to_n <span class="symbol">$</span> mod (n_to_i (ordinal i) <span class="symbol">-</span> 1) <span class="symbol">$</span> n_to_i <span class="symbol">$</span> size n
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> finite_difference_neighbours {n a} [<span class="type-name">Sub</span> a<span class="symbol">,</span> <span class="type-name">Add</span> a] (x<span class="command">:n</span><span class="symbol">=&gt;</span>a) <span class="symbol">:</span> n<span class="symbol">=&gt;</span>a <span class="symbol">=</span>
  <span class="keyword">for</span> i<span class="symbol">.</span> x<span class="symbol">.</span>(incwrap i) <span class="symbol">-</span> x<span class="symbol">.</span>(decwrap i)
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> add_neighbours {n a} [<span class="type-name">Add</span> a] (x<span class="command">:n</span><span class="symbol">=&gt;</span>a) <span class="symbol">:</span> n<span class="symbol">=&gt;</span>a <span class="symbol">=</span>
  <span class="keyword">for</span> i<span class="symbol">.</span> x<span class="symbol">.</span>(incwrap i) <span class="symbol">+</span> x<span class="symbol">.</span>(decwrap i)
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> apply_along_axis1 {b c a} (f<span class="command">:b</span><span class="symbol">=&gt;</span>a <span class="symbol">-&gt;</span> b<span class="symbol">=&gt;</span>a) (x<span class="command">:b</span><span class="symbol">=&gt;</span>c<span class="symbol">=&gt;</span>a) <span class="symbol">:</span> b<span class="symbol">=&gt;</span>c<span class="symbol">=&gt;</span>a <span class="symbol">=</span>
  transpose <span class="keyword">for</span> j<span class="symbol">.</span> f <span class="keyword">for</span> i<span class="symbol">.</span> x<span class="symbol">.</span>i<span class="symbol">.</span>j
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> apply_along_axis2 {b c a} (f<span class="command">:c</span><span class="symbol">=&gt;</span>a <span class="symbol">-&gt;</span> c<span class="symbol">=&gt;</span>a) (x<span class="command">:b</span><span class="symbol">=&gt;</span>c<span class="symbol">=&gt;</span>a) <span class="symbol">:</span> b<span class="symbol">=&gt;</span>c<span class="symbol">=&gt;</span>a <span class="symbol">=</span>
  <span class="keyword">for</span> i<span class="symbol">.</span> f x<span class="symbol">.</span>i
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> fdx {n m a} [<span class="type-name">Sub</span> a<span class="symbol">,</span> <span class="type-name">Add</span> a] (x<span class="command">:n</span><span class="symbol">=&gt;</span>m<span class="symbol">=&gt;</span>a) <span class="symbol">:</span> (n<span class="symbol">=&gt;</span>m<span class="symbol">=&gt;</span>a) <span class="symbol">=</span>
  apply_along_axis1 finite_difference_neighbours x
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> fdy {n m a} [<span class="type-name">Sub</span> a<span class="symbol">,</span> <span class="type-name">Add</span> a] (x<span class="command">:n</span><span class="symbol">=&gt;</span>m<span class="symbol">=&gt;</span>a) <span class="symbol">:</span> (n<span class="symbol">=&gt;</span>m<span class="symbol">=&gt;</span>a) <span class="symbol">=</span>
  apply_along_axis2 finite_difference_neighbours x
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> divergence {n m a} [<span class="type-name">Sub</span> a<span class="symbol">,</span> <span class="type-name">Add</span> a] (vx<span class="command">:n</span><span class="symbol">=&gt;</span>m<span class="symbol">=&gt;</span>a) (vy<span class="command">:n</span><span class="symbol">=&gt;</span>m<span class="symbol">=&gt;</span>a) <span class="symbol">:</span> (n<span class="symbol">=&gt;</span>m<span class="symbol">=&gt;</span>a) <span class="symbol">=</span>
  fdx vx <span class="symbol">+</span> fdy vy
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> add_neighbours_2d {n m a} [<span class="type-name">Add</span> a] (x<span class="command">:n</span><span class="symbol">=&gt;</span>m<span class="symbol">=&gt;</span>a) <span class="symbol">:</span> (n<span class="symbol">=&gt;</span>m<span class="symbol">=&gt;</span>a) <span class="symbol">=</span>
  ax1 <span class="symbol">=</span> apply_along_axis1 add_neighbours x
  ax2 <span class="symbol">=</span> apply_along_axis2 add_neighbours x
  ax1 <span class="symbol">+</span> ax2
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> project_vel {n m a} [<span class="type-name">VSpace</span> a] (v<span class="symbol">:</span> n<span class="symbol">=&gt;</span>m<span class="symbol">=&gt;</span>(<span class="type-name">Fin</span> 2)<span class="symbol">=&gt;</span>a) <span class="symbol">:</span> n<span class="symbol">=&gt;</span>m<span class="symbol">=&gt;</span>(<span class="type-name">Fin</span> 2)<span class="symbol">=&gt;</span>a <span class="symbol">=</span>
  <span class="comment">-- Project_vel the velocity field to be approximately mass-conserving,
</span>  <span class="comment">-- using a few iterations of Gauss-Seidel.
</span>  h <span class="symbol">=</span> 1<span class="symbol">.</span>0 <span class="symbol">/</span> n_to_f (size n)

  <span class="comment">-- unpack into two scalar fields
</span>  vx <span class="symbol">=</span> <span class="keyword">for</span> i j<span class="symbol">.</span> v<span class="symbol">.</span>i<span class="symbol">.</span>j<span class="symbol">.</span>(from_ordinal _ 0)
  vy <span class="symbol">=</span> <span class="keyword">for</span> i j<span class="symbol">.</span> v<span class="symbol">.</span>i<span class="symbol">.</span>j<span class="symbol">.</span>(from_ordinal _ 1)

  div <span class="symbol">=</span> <span class="symbol">-</span>0<span class="symbol">.</span>5 <span class="symbol">.*</span> h <span class="symbol">.*</span> (divergence vx vy)

  p <span class="symbol">=</span> yield_state zero <span class="symbol">\</span>state<span class="symbol">.</span>
    <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> 10)<span class="symbol">.</span>
      state <span class="symbol">:=</span> (1<span class="symbol">.</span>0 <span class="symbol">/</span> 4<span class="symbol">.</span>0) <span class="symbol">.*</span> (div <span class="symbol">+</span> add_neighbours_2d (get state))

  vx <span class="symbol">=</span> vx <span class="symbol">-</span> (0<span class="symbol">.</span>5 <span class="symbol">/</span> h) <span class="symbol">.*</span> fdx(p)
  vy <span class="symbol">=</span> vy <span class="symbol">-</span> (0<span class="symbol">.</span>5 <span class="symbol">/</span> h) <span class="symbol">.*</span> fdy(p)

  <span class="keyword">for</span> i j<span class="symbol">.</span> [vx<span class="symbol">.</span>i<span class="symbol">.</span>j<span class="symbol">,</span> vy<span class="symbol">.</span>i<span class="symbol">.</span>j]  <span class="comment">-- pack back into a table.
</span></div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> bilinear_interp {a} [<span class="type-name">VSpace</span> a] (right_weight<span class="symbol">:</span><span class="type-name">Float</span>) (bottom_weight<span class="symbol">:</span><span class="type-name">Float</span>)
  (topleft<span class="symbol">:</span> a) (bottomleft<span class="symbol">:</span> a) (topright<span class="symbol">:</span> a) (bottomright<span class="symbol">:</span> a) <span class="symbol">:</span> a <span class="symbol">=</span>
  left  <span class="symbol">=</span> (1<span class="symbol">.</span>0 <span class="symbol">-</span> right_weight) <span class="symbol">.*</span> ((1<span class="symbol">.</span>0 <span class="symbol">-</span> bottom_weight) <span class="symbol">.*</span> topleft  <span class="symbol">+</span> bottom_weight <span class="symbol">.*</span> bottomleft)
  right <span class="symbol">=</span>        right_weight  <span class="symbol">.*</span> ((1<span class="symbol">.</span>0 <span class="symbol">-</span> bottom_weight) <span class="symbol">.*</span> topright <span class="symbol">+</span> bottom_weight <span class="symbol">.*</span> bottomright)
  left <span class="symbol">+</span> right
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> advect {n m a} [<span class="type-name">VSpace</span> a] (f<span class="symbol">:</span> n<span class="symbol">=&gt;</span>m<span class="symbol">=&gt;</span>a) (v<span class="symbol">:</span> n<span class="symbol">=&gt;</span>m<span class="symbol">=&gt;</span>(<span class="type-name">Fin</span> 2)<span class="symbol">=&gt;</span><span class="type-name">Float</span>) <span class="symbol">:</span> n<span class="symbol">=&gt;</span>m<span class="symbol">=&gt;</span>a <span class="symbol">=</span>
  <span class="comment">-- Move field f according to x and y velocities (u and v)
</span>  <span class="comment">-- using an implicit Euler integrator.
</span>
  cell_xs <span class="symbol">=</span> linspace n 0<span class="symbol">.</span>0 <span class="symbol">$</span> n_to_f (size n)
  cell_ys <span class="symbol">=</span> linspace m 0<span class="symbol">.</span>0 <span class="symbol">$</span> n_to_f (size m)

  <span class="keyword">for</span> i j<span class="symbol">.</span>
    <span class="comment">-- Location of source of flow for this cell.  No meshgrid!
</span>    center_xs <span class="symbol">=</span> cell_xs<span class="symbol">.</span>i <span class="symbol">-</span> v<span class="symbol">.</span>i<span class="symbol">.</span>j<span class="symbol">.</span>(from_ordinal _ 0)
    center_ys <span class="symbol">=</span> cell_ys<span class="symbol">.</span>j <span class="symbol">-</span> v<span class="symbol">.</span>i<span class="symbol">.</span>j<span class="symbol">.</span>(from_ordinal _ 1)

    <span class="comment">-- Index of source cell.
</span>    source_col <span class="symbol">=</span> floor center_xs
    source_row <span class="symbol">=</span> floor center_ys

    <span class="comment">-- Relative weight of right-hand and bottom cells.
</span>    right_weight  <span class="symbol">=</span> center_xs <span class="symbol">-</span> source_col
    bottom_weight <span class="symbol">=</span> center_ys <span class="symbol">-</span> source_row

    <span class="comment">-- Cast back to indices, wrapping around edges.
</span>    l <span class="symbol">=</span> wrapidx n  (f_to_i source_col)
    r <span class="symbol">=</span> wrapidx n ((f_to_i source_col) <span class="symbol">+</span> 1)
    t <span class="symbol">=</span> wrapidx m  (f_to_i source_row)
    b <span class="symbol">=</span> wrapidx m ((f_to_i source_row) <span class="symbol">+</span> 1)

    <span class="comment">-- A convex weighting of the 4 surrounding cells.
</span>    bilinear_interp right_weight bottom_weight f<span class="symbol">.</span>l<span class="symbol">.</span>t f<span class="symbol">.</span>l<span class="symbol">.</span>b f<span class="symbol">.</span>r<span class="symbol">.</span>t f<span class="symbol">.</span>r<span class="symbol">.</span>b
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> fluidsim {n m a} [<span class="type-name">VSpace</span> a] (num_steps<span class="symbol">:</span> <span class="type-name">Nat</span>) (color_init<span class="symbol">:</span> n<span class="symbol">=&gt;</span>m<span class="symbol">=&gt;</span>a)
  (v<span class="symbol">:</span> n<span class="symbol">=&gt;</span>m<span class="symbol">=&gt;</span>(<span class="type-name">Fin</span> 2)<span class="symbol">=&gt;</span><span class="type-name">Float</span>) <span class="symbol">:</span> (<span class="type-name">Fin</span> num_steps)<span class="symbol">=&gt;</span>n<span class="symbol">=&gt;</span>m<span class="symbol">=&gt;</span>a <span class="symbol">=</span>
  with_state (color_init<span class="symbol">,</span> v) <span class="symbol">\</span>state<span class="symbol">.</span>
    <span class="keyword">for</span> i<span class="symbol">:</span>(<span class="type-name">Fin</span> num_steps)<span class="symbol">.</span>
      (color<span class="symbol">,</span> v) <span class="symbol">=</span> get state
      v <span class="symbol">=</span> advect v v          <span class="comment">-- Move velocities
</span>      v <span class="symbol">=</span> project_vel v       <span class="comment">-- Project to be volume-preserving
</span>      color&#39; <span class="symbol">=</span> advect color v <span class="comment">-- Move color
</span>      state <span class="symbol">:=</span> (color&#39;<span class="symbol">,</span> v)
      color
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="prose-block"><h3>Demo</h3>
</div></div><div class="cell"><div class="code-block"><span class="type-name">N</span> <span class="symbol">=</span> <span class="type-name">Fin</span> 50
</div></div><div class="cell"><div class="code-block"><span class="type-name">M</span> <span class="symbol">=</span> <span class="type-name">Fin</span> 50
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- Create random velocity field.
</span></div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> ixkey3 {n m o} [<span class="type-name">Ix</span> n<span class="symbol">,</span> <span class="type-name">Ix</span> m<span class="symbol">,</span> <span class="type-name">Ix</span> o] (k<span class="symbol">:</span><span class="type-name">Key</span>) (i<span class="command">:n</span>) (j<span class="command">:m</span>) (k2<span class="command">:o</span>) <span class="symbol">:</span> <span class="type-name">Key</span> <span class="symbol">=</span>
  hash (hash (hash k (ordinal i)) (ordinal j)) (ordinal k2)
</div></div><div class="cell"><div class="code-block">init_velocity <span class="symbol">=</span> <span class="keyword">for</span> i<span class="symbol">:</span><span class="type-name">N</span> j<span class="symbol">:</span><span class="type-name">M</span> k<span class="symbol">:</span>(<span class="type-name">Fin</span> 2)<span class="symbol">.</span>
  3<span class="symbol">.</span>0 <span class="symbol">*</span> (randn <span class="symbol">$</span> ixkey3 (new_key 0) i j k)
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- Create diagonally-striped color pattern.
</span></div></div><div class="cell"><div class="code-block">init_color <span class="symbol">=</span> <span class="keyword">for</span> i<span class="symbol">:</span><span class="type-name">N</span> j<span class="symbol">:</span><span class="type-name">M</span><span class="symbol">.</span>
  i&#39; <span class="symbol">=</span> n_to_f <span class="symbol">$</span> ordinal i
  j&#39; <span class="symbol">=</span> n_to_f <span class="symbol">$</span> ordinal j
  r <span class="symbol">=</span> b_to_f <span class="symbol">$</span> (sin <span class="symbol">$</span> (j&#39; <span class="symbol">+</span> i&#39;) <span class="symbol">/</span> 8<span class="symbol">.</span>0) <span class="symbol">&gt;</span> 0<span class="symbol">.</span>0
  b <span class="symbol">=</span> b_to_f <span class="symbol">$</span> (sin <span class="symbol">$</span> (j&#39; <span class="symbol">-</span> i&#39;) <span class="symbol">/</span> 6<span class="symbol">.</span>0) <span class="symbol">&gt;</span> 0<span class="symbol">.</span>0
  g <span class="symbol">=</span> b_to_f <span class="symbol">$</span> (sin <span class="symbol">$</span> (j&#39; <span class="symbol">+</span> i&#39;) <span class="symbol">/</span> 4<span class="symbol">.</span>0) <span class="symbol">&gt;</span> 0<span class="symbol">.</span>0
  [r<span class="symbol">,</span> g<span class="symbol">,</span> b]
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- Run fluid sim and plot it.
</span></div></div><div class="cell"><div class="code-block">num_steps <span class="symbol">=</span> 5
</div></div><div class="cell"><div class="code-block"><span class="command">:html</span> imseqshow <span class="symbol">$</span> fluidsim num_steps init_color init_velocity
</div><img class="plot-img" src="data:image/png;base64, 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"></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="prose-block"><h3>Gradient test</h3>
</div></div><div class="cell"><div class="code-block">target <span class="symbol">=</span> transpose init_color
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="comment">-- This is partial
</span></div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> last {n a} (xs<span class="command">:n</span><span class="symbol">=&gt;</span>a) <span class="symbol">:</span> a <span class="symbol">=</span> xs<span class="symbol">.</span>((unsafe_nat_diff (size n) 1)<span class="symbol">@</span>_)
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> objective (v<span class="symbol">:</span><span class="type-name">N</span><span class="symbol">=&gt;</span><span class="type-name">M</span><span class="symbol">=&gt;</span>(<span class="type-name">Fin</span> 2)<span class="symbol">=&gt;</span><span class="type-name">Float</span>) <span class="symbol">:</span> <span class="type-name">Float</span> <span class="symbol">=</span>
  final_color <span class="symbol">=</span> last <span class="symbol">$</span> fluidsim num_steps init_color v
  sum <span class="keyword">for</span> (i<span class="symbol">,</span> j<span class="symbol">,</span> c)<span class="symbol">.</span> sq (final_color<span class="symbol">.</span>i<span class="symbol">.</span>j<span class="symbol">.</span>c <span class="symbol">-</span> target<span class="symbol">.</span>i<span class="symbol">.</span>j<span class="symbol">.</span>c)
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block">init_vel_grad <span class="symbol">=</span> grad objective zero
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:html</span> imshow <span class="keyword">for</span> i j<span class="symbol">.</span> [0<span class="symbol">.</span>0<span class="symbol">,</span> init_vel_grad<span class="symbol">.</span>i<span class="symbol">.</span>j<span class="symbol">.</span>(0<span class="symbol">@</span>_)<span class="symbol">,</span> init_vel_grad<span class="symbol">.</span>i<span class="symbol">.</span>j<span class="symbol">.</span>(1<span class="symbol">@</span>_)]
</div><img class="plot-img" src="data:image/png;base64, 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"></div></div></body></html>